"use strict";const e=require("../../../common/vendor.js"),o=require("../../../local/index.js");require("../../../hooks/uni-hooks/new-dialog.js"),require("../../../store/modules/app.js");const s=require("../../../store/modules/device.js");require("../../../store/modules/order.js");const r=require("../../../store/modules/user.js");require("../../../hooks/uni-hooks/dialog.js"),require("../../../hooks/uni-hooks/request.js");const u=require("../../../hooks/uni-hooks/unite.js");require("../../../hooks/uni-hooks/wechat.js");const i=require("../../../api/coupon.js");require("../../../hooks/useCountryCode.js");const n=require("../../../hooks/use-mix.js");require("../../../utils/uniAsync.js"),require("../../../utils/wx.log.js");const t=require("../../../utils/config/index.js"),c=require("./hook.js");if(require("../../../shared/cache.js"),require("../../../const/cache.js"),require("../../../hooks/uni-hooks/cache.js"),require("../../../utils/config/env.js"),require("../../../const/platform.js"),require("../../../uni_modules/mot-utils/index.js"),require("../../../theme/hooks/useTheme.js"),require("../../../theme/hooks/themeConfig.js"),require("../../../theme/hooks/themeKeys.js"),require("../../../api/device.js"),require("../../../api/order.js"),require("../../../api/user.js"),require("../../../const/order.js"),require("../../../hooks/uni-hooks/router.js"),require("../../../hooks/usePromise.js"),require("../../../api/delivery.js"),require("../../../shared/device.js"),require("../../../const/common.js"),require("../../../utils/appEnterVerif.js"),require("../../../hooks/use-common.js"),require("../../../hooks/uni-hooks/loading.js"),require("../../../hooks/uni-hooks/common.js"),require("../../../utils/url.js"),require("../../../hooks/uni-hooks/report.js"),require("../../../api/data.js"),require("../../../utils/precision.js"),require("../../../shared/order.js"),require("../../../shared/pay.js"),require("../../../utils/is.js"),require("../../../hooks/useWechatSI.js"),require("../../../hooks/use-keyval/index.js"),require("../../../const/coupon.js"),!Array){(e.resolveComponent("mot-button")+e.resolveComponent("mot-modal"))()}Math||(d+(()=>"../../../uni_modules/mot-button/components/mot-button/mot-button.js")+(()=>"../../../uni_modules/mot-modal/components/mot-modal/mot-modal.js"))();const d=()=>"../../../components/v1/coupon/coupon-list-item.js",a=e.defineComponent({__name:"index",setup(d){const a=e.ref({}),{createCouponOrder:l}=c.useOperation(a),h=e.ref([]),q=r.useUserStore();s.useDeviceStore(),e.onLoad((async e=>{u.unite.setNavigationBarTitle(o.t("components.v1.coupon.coupon-panel.1")),await q.fetchUser();const{id:s,siteId:r,shopId:i,qrCodeId:n}=e||{},t=s?{id:s}:r?{site_id:r}:i?{shop_id:i}:{};n&&(t.qr_code_id=n),m(t)}));const j=e.computed((()=>{const{shop:e,site:o}=h.value[0]||{};return p.value?null==e?void 0:e.name:null==o?void 0:o.name})),p=e.ref(!1),m=async e=>{e.shop_id&&(p.value=!0);const o=await i.couponApi.findCouponPackages(e);h.value=o,k(o[0]),a.value=o[0]},k=e=>{a.value=e},f=e.ref();return(s,r)=>({a:e.unref(t.config).fileBaseUrl+"/coupon_bg_zh.png",b:e.t(e.unref(o.t)("me.buy-coupon.index.1")+e.unref(j)+e.unref(o.t)("me.buy-coupon.index.2")),c:e.f(e.unref(h),((o,s,r)=>{var u;return{a:"4fc66eed-0-"+r,b:e.p({coupon:o,active:(null==o?void 0:o.id)===(null==(u=e.unref(a))?void 0:u.id)}),c:e.o((e=>k(o)),null==o?void 0:o.id),d:null==o?void 0:o.id}})),d:e.t(e.unref(n.useToYuan)(e.unref(a).payed)),e:e.t(e.unref(o.t)("components.business.coupon-dialog.index.5")),f:e.o(e.unref(l)),g:e.p({shape:"square",isBlock:!0}),h:e.sr(f,"4fc66eed-2",{k:"ModalRef"}),i:e.p({id:"ModalRef"})})}}),l=e._export_sfc(a,[["__scopeId","data-v-4fc66eed"]]);wx.createPage(l);
