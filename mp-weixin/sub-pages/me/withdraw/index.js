"use strict";const e=require("../../../common/vendor.js"),r=require("../../../local/index.js"),o=require("../../../hooks/uni-hooks/new-dialog.js");require("../../../store/modules/app.js"),require("../../../store/modules/device.js"),require("../../../store/modules/order.js");const s=require("../../../store/modules/user.js");require("../../../utils/uniAsync.js"),require("../../../utils/wx.log.js");const i=require("../../../utils/config/index.js");require("../../../hooks/uni-hooks/dialog.js");const u=require("../../../hooks/uni-hooks/emitKey.js");require("../../../hooks/uni-hooks/request.js");const n=require("../../../hooks/uni-hooks/unite.js"),t=require("../../../hooks/uni-hooks/wechat.js");require("../../../hooks/useCountryCode.js");const a=require("../../../hooks/use-mix.js"),d=require("../../../api/order.js"),l=require("../../../api/user.js"),m=require("../../../hooks/useAd.js"),c=require("./hooks/use-vip.js");if(require("../../../shared/cache.js"),require("../../../const/cache.js"),require("../../../hooks/uni-hooks/cache.js"),require("../../../utils/config/env.js"),require("../../../const/platform.js"),require("../../../uni_modules/mot-utils/index.js"),require("../../../theme/hooks/useTheme.js"),require("../../../theme/hooks/themeConfig.js"),require("../../../theme/hooks/themeKeys.js"),require("../../../api/device.js"),require("../../../const/order.js"),require("../../../hooks/uni-hooks/router.js"),require("../../../hooks/usePromise.js"),require("../../../api/delivery.js"),require("../../../shared/device.js"),require("../../../const/common.js"),require("../../../utils/appEnterVerif.js"),require("../../../hooks/use-common.js"),require("../../../hooks/uni-hooks/loading.js"),require("../../../hooks/uni-hooks/common.js"),require("../../../utils/url.js"),require("../../../hooks/uni-hooks/report.js"),require("../../../api/data.js"),require("../../../utils/precision.js"),require("../../../api/coupon.js"),!Array){(e.resolveComponent("mot-button")+e.resolveComponent("mot-modal"))()}Math||((()=>"../../../uni_modules/mot-button/components/mot-button/mot-button.js")+(()=>"../../../uni_modules/mot-modal/components/mot-modal/mot-modal.js")+p)();const p=()=>"./components/activity-popup.js",h=e.defineComponent({__name:"index",setup(p){const h=s.useUserStore(),j=e.reactive({user:{},loading:!1});e.onLoad((async()=>{t.envEvent.report.addPage({page_name:"a_page_withdraw_view"}),await g(),n.unite.setNavigationBarTitle(r.t("pages.my_balance"));const{enable_vip_package:e,has_vip_package_order:o}=j.user;e&&i.config.isAnLv&&!o&&A()}));const{clickAd:q}=m.uesAd(),v=()=>{t.envEvent.report.commonClk("提现详情页_提现记录按钮_点击")},f=()=>{var e;t.envEvent.report.commonClk("提现详情页_立即查看活动banner_点击"),C(null==(e=E.value)?void 0:e.id)},k=()=>{var e;if(null==(e=E.value)?void 0:e.price)return t.envEvent.report.commonExp("提现详情页_提现弹窗提示_曝光"),void o.confirm("确定不参与余额升级权益卡活动么？","提示","查看活动","残忍拒绝").then((()=>{t.envEvent.report.commonClk("提现详情页_提现弹窗提示_查看活动按钮点击"),C(E.value.id)}),(()=>{t.envEvent.report.commonClk("提现详情页_提现弹窗提示_残忍拒绝按钮点击"),_()}));_()},_=async()=>{try{j.loading=!0,await d.paymentApi.post(j.user.balance),g(),e.index.$emit(u.EMIT_REFRESH_ME),j.loading=!1,o.alert(r.t("sub-pages.me.withdraw.index.9"),r.t("sub-pages.me.withdraw.index.8")).then((()=>{q("withdrawal_success_ad")})).catch((()=>{})),A()}finally{j.loading=!1}},g=async()=>{const e=await l.userApi.get();j.user=e,h.setUserInfo(j.user)},{loading:w,user:b}=e.toRefs(j),x=e.ref(),{showVip:y,suitVipItem:E,gotoVipPage:C,setVip:A}=c.useVip(j),V=e.computed((()=>{var e;return i.config.fileBaseUrl+(null==(e=E.value)?void 0:e.img_m_url)}));return(o,s)=>{var i,u,n;return e.e({a:e.t(e.unref(r.t)("sub-pages.me.withdraw.index.1")),b:e.o(v),c:e.t(e.unref(a.useToYuan)(e.unref(b).balance)),d:e.t(e.unref(r.t)("sub-pages.me.withdraw.index.2")),e:null==(i=e.unref(E))?void 0:i.price},(null==(u=e.unref(E))?void 0:u.price)?{f:e.unref(V),g:e.o(f)}:{},{h:e.t(e.unref(r.t)("v1_me.btn")),i:e.o(k),j:e.p({disabled:!(e.unref(b).balance>0),type:(null==(n=e.unref(E))?void 0:n.price)?"default":"primary",isBlock:!0,shape:"square",loading:e.unref(w)}),k:e.t(e.unref(r.t)("sub-pages.me.withdraw.index.5")),l:e.t(e.unref(r.t)("sub-pages.me.withdraw.index.6")),m:e.t(e.unref(r.t)("sub-pages.me.withdraw.index.7")),n:e.sr(x,"dfe8de47-1",{k:"ModalRef"}),o:e.p({id:"ModalRef"}),p:e.o((r=>e.unref(C)(e.unref(E).id))),q:e.o((r=>e.isRef(y)?y.value=r:null)),r:e.p({modelValue:e.unref(y)})})}}}),j=e._export_sfc(h,[["__scopeId","data-v-dfe8de47"]]);wx.createPage(j);
