"use strict";const e=require("../../../common/vendor.js"),o=require("../../../local/index.js");require("../../../hooks/uni-hooks/new-dialog.js"),require("../../../store/modules/app.js"),require("../../../store/modules/device.js"),require("../../../store/modules/order.js");const r=require("../../../store/modules/user.js");require("../../../utils/uniAsync.js"),require("../../../utils/wx.log.js");const s=require("../../../utils/config/index.js"),i=require("../../../hooks/uni-hooks/dialog.js"),t=require("../../../hooks/uni-hooks/emitKey.js");require("../../../hooks/uni-hooks/request.js");const u=require("../../../hooks/uni-hooks/router.js"),n=require("../../../hooks/uni-hooks/unite.js");require("../../../hooks/uni-hooks/wechat.js");const a=require("../../../hooks/useUpload.js");if(require("../../../hooks/useCountryCode.js"),require("../../../shared/cache.js"),require("../../../const/cache.js"),require("../../../hooks/uni-hooks/cache.js"),require("../../../utils/config/env.js"),require("../../../const/platform.js"),require("../../../uni_modules/mot-utils/index.js"),require("../../../theme/hooks/useTheme.js"),require("../../../theme/hooks/themeConfig.js"),require("../../../theme/hooks/themeKeys.js"),require("../../../api/device.js"),require("../../../api/order.js"),require("../../../api/user.js"),require("../../../const/order.js"),require("../../../hooks/usePromise.js"),require("../../../api/delivery.js"),require("../../../shared/device.js"),require("../../../const/common.js"),require("../../../utils/appEnterVerif.js"),require("../../../hooks/use-common.js"),require("../../../hooks/uni-hooks/loading.js"),require("../../../hooks/uni-hooks/common.js"),require("../../../utils/url.js"),require("../../../hooks/uni-hooks/report.js"),require("../../../api/data.js"),!Array){(e.resolveComponent("mot-button")+e.resolveComponent("mot-modal"))()}Math||((()=>"../../../uni_modules/mot-button/components/mot-button/mot-button.js")+(()=>"../../../uni_modules/mot-modal/components/mot-modal/mot-modal.js"))();const l=e.defineComponent({__name:"index",setup(l){const m=r.useUserStore(),c=s.config.fileBaseUrl+"/avatar.png",d=e.reactive({avatarUrl:m.user.avatar_url||c,nickname:m.user.nickname});e.onShow((()=>{n.unite.setNavigationBarTitle(o.t("me.profile.title"))}));const h=async e=>{console.log("[ onChooseAvatar e ] >",e);const{avatarUrl:o}=e.detail;d.avatarUrl=await a.useUploadImage(o)},j=e=>{const{avatarUrl:r,nickname:s}=d;r&&s?q(s,r):i.dialog.toast(o.t("me.profile.toast.nickname"))},q=async(r,s)=>{await m.updateUser(m.user.id,{nickname:r,avatar_url:s}),e.index.$emit(t.EMIT_REFRESH_ME,{nickname:r,avatar_url:s}),i.dialog.toast(o.t("me.profile.toast.success")),u.navigateBack()},{avatarUrl:k,nickname:p}=e.toRefs(d),f=e.ref();return(r,i)=>({a:e.unref(s.config).fileBaseUrl+"/me/me_bg.png",b:e.unref(k),c:e.o(h),d:e.t(e.unref(o.t)("me.profile.desc")),e:e.t(e.unref(o.t)("me.profile.nickname")),f:e.unref(o.t)("me.profile.nickname_placeholder"),g:e.unref(p),h:e.o((o=>e.isRef(p)?p.value=o.detail.value:null)),i:e.t(e.unref(o.t)("me.profile.nickname_tip")),j:e.t(e.unref(o.t)("me.profile.btn")),k:e.o(j),l:e.p({shape:"square",isBlock:!0}),m:e.sr(f,"055f1224-1",{k:"ModalRef"}),n:e.p({id:"ModalRef"})})}}),m=e._export_sfc(l,[["__scopeId","data-v-055f1224"]]);wx.createPage(m);
