"use strict";const e=require("../../../common/vendor.js"),r=require("../../../api/device.js"),o=require("../../../local/index.js");require("../../../hooks/uni-hooks/new-dialog.js"),require("../../../store/modules/app.js");const s=require("../../../store/modules/device.js");require("../../../store/modules/order.js"),require("../../../store/modules/user.js");const n=require("../../../const/site.js");require("../../../utils/uniAsync.js"),require("../../../utils/wx.log.js");const i=require("../../../utils/config/index.js");require("../../../hooks/uni-hooks/dialog.js"),require("../../../hooks/uni-hooks/request.js");const t=require("../../../hooks/uni-hooks/router.js"),u=require("../../../hooks/uni-hooks/unite.js"),c=require("../../../hooks/uni-hooks/wechat.js");require("../../../hooks/useCountryCode.js");const a=require("../../../hooks/use-keyval/index.js");if(require("../../../shared/cache.js"),require("../../../const/cache.js"),require("../../../hooks/uni-hooks/cache.js"),require("../../../utils/config/env.js"),require("../../../const/platform.js"),require("../../../uni_modules/mot-utils/index.js"),require("../../../theme/hooks/useTheme.js"),require("../../../theme/hooks/themeConfig.js"),require("../../../theme/hooks/themeKeys.js"),require("../../../api/order.js"),require("../../../api/user.js"),require("../../../const/order.js"),require("../../../hooks/usePromise.js"),require("../../../api/delivery.js"),require("../../../shared/device.js"),require("../../../const/common.js"),require("../../../utils/appEnterVerif.js"),require("../../../hooks/use-common.js"),require("../../../hooks/uni-hooks/loading.js"),require("../../../hooks/uni-hooks/common.js"),require("../../../utils/url.js"),require("../../../hooks/uni-hooks/report.js"),require("../../../api/data.js"),require("../../../const/coupon.js"),!Array){(e.resolveComponent("mot-button")+e.resolveComponent("mot-modal"))()}Math||(l+(()=>"../../../uni_modules/mot-button/components/mot-button/mot-button.js")+(()=>"../../../uni_modules/mot-modal/components/mot-modal/mot-modal.js"))();const l=()=>"../../../components/mot-site/index.js",d=e.defineComponent({__name:"index",setup(l){const d=s.useDeviceStoreRefs(),p=s.useDeviceStore(),{cabinet:f}=d,m=e.reactive({scene:"",cabinets:[]});e.onLoad((e=>{const{scene:r=""}=e||{};m.scene=r,k(e)})),e.onShow((()=>{u.unite.setNavigationBarTitle(o.t("device_nearby.title"))}));const h=e.ref(""),{LockerTypeTextMap:j}=a.useKeyval(),k=async({type:e})=>{h.value=e||"";const o={cabinet_id:f.value.id};e&&(o.locker_type=+e);const s=await r.deviceApi.nearbyCabinet(o);m.cabinets=s||[],m.cabinets.length||c.envEvent.report.addExp("a_page_device_nearby_exp")},q=()=>{c.envEvent.scanCode().then((e=>{v(e)}))},v=async e=>{await p.fetchCabinet(e),p.goNextPage()},b=e=>e>=10,{cabinets:g}=e.toRefs(m),_=()=>{c.envEvent.report.addClick("a_page_device_nearby_clk"),e.wx$1.openEmbeddedMiniProgram({appId:"wx1865eb2062ce1c33",path:"pages/middle/index?source=XiaoTieJiCunGui"})},y=e.computed((()=>p.site.related_sites.iamge_url)),x=()=>{y.value&&e.index.previewImage({urls:[y.value]})},w=e.ref();return(r,s)=>e.e({a:e.t(e.unref(f).address),b:e.t(e.unref(o.t)("device_nearby.full")),c:e.unref(i.config).fileBaseUrl+"/nearby-cabinet.png",d:e.t(e.unref(o.t)("device_nearby.desc")),e:e.unref(y)&&e.unref(y).length},e.unref(y)&&e.unref(y).length?{f:e.unref(i.config).fileBaseUrl+"/ditulei_ditu.png",g:e.t(e.unref(o.t)("sub-pages.common.device-nearby.index.6")),h:e.o(x),i:e.p({size:"small",plain:!0,customColor:"#576b95"})}:{},{j:e.f(e.unref(g),((r,o,s)=>{return{a:(n=null==r?void 0:r.free_locker_count,b(n)?i.config.fileBaseUrl+"/locker/success.png":i.config.fileBaseUrl+"/locker/primary.png"),b:e.t(r.address),c:e.f(r.locker_types,((o,s,n)=>({a:e.t(e.unref(j)[o]),b:e.t(r.locker_count_map[o])}))),d:r.name,e:e.n({success:b(null==r?void 0:r.free_locker_count)})};var n})),k:e.t(e.unref(o.t)("v1_device_type.available")),l:e.n(e.unref(g).length>0?"flex":""),m:!e.unref(g).length&&e.unref(m).scene!==e.unref(n.lockerSenceMap).express},e.unref(g).length||e.unref(m).scene===e.unref(n.lockerSenceMap).express?{}:{n:e.unref(i.config).fileBaseUrl+"/wuyoucun.png",o:e.o(_)},{p:e.unref(m).scene!==e.unref(n.lockerSenceMap).express},e.unref(m).scene!==e.unref(n.lockerSenceMap).express?e.e({q:e.unref(g).length},e.unref(g).length?{r:e.t(e.unref(o.t)("device_nearby.btn.scan")),s:e.o(q),t:e.p({isBlock:!0,type:"primary",shape:"square"}),v:e.t(e.unref(o.t)("device_nearby.btn.back")),w:e.o(e.unref(t.goHome)),x:e.p({isBlock:!0,shape:"square",type:"info"}),y:e.sr(w,"9ac284bb-4",{k:"ModalRef"}),z:e.p({id:"ModalRef"})}:{}):{})}}),p=e._export_sfc(d,[["__scopeId","data-v-9ac284bb"]]);wx.createPage(p);
