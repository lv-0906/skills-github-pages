"use strict";const e=require("../../../local/index.js");require("../../../store/modules/app.js"),require("../../../store/modules/device.js"),require("../../../store/modules/order.js");const o=require("../../../store/modules/user.js"),u=require("../../../common/vendor.js");require("../../../hooks/uni-hooks/new-dialog.js"),require("../../../utils/uniAsync.js");const n=require("../../../utils/validate.js");require("../../../utils/wx.log.js"),require("../../../utils/config/index.js");const s=require("../../../hooks/uni-hooks/dialog.js");require("../../../hooks/uni-hooks/request.js");const r=require("../../../hooks/uni-hooks/unite.js");require("../../../hooks/uni-hooks/wechat.js");const a=require("../../../api/user.js");require("../../../hooks/useCountryCode.js");const t=o.useUserStore();exports.useCode=(o,r,t)=>{let i=0;let l=u.ref(60);const g=u.ref(!1),c=u.computed((()=>60===l.value?e.t("sub-pages.common.login.4"):l.value+"s"));return u.onUnload((()=>{clearInterval(i)})),{getCode:async u=>{if(g.value)return;if(u.value&&u.value.length?n.isRegCode(o.phone,r.value,u.value,"phone"):n.isInternationalPhone(o.phone)){g.value=!0;try{await a.userApi.postPhoneCode({phone:{country_code:t.value||"+86",phone_number:o.phone},serve:"h5_login"}),l.value=l.value-1,i=setInterval((()=>{l.value=l.value-1,0===l.value&&(clearInterval(i),l.value=60,g.value=!1)}),1e3)}catch(c){return void(g.value=!1)}}else s.toast(e.t("pages.common.login.index.2"))},codeButtonText:c}},exports.useLang=o=>{const n=u.ref(!1),s=u.computed((()=>e.langsMap[t.language])),a=u.computed((()=>{const o=t.language;return e.langImgPath[o].loginbgImg}));return{showLanguagePopup:n,onShowLanguagePopup:()=>{n.value=!0},onChangeLanguage:o=>{e.changeLanguage(o),r.unite.setNavigationBarTitle(e.t("pages.common.login.index.1")),t.language=o},languageText:s,bannerImg:a}};
