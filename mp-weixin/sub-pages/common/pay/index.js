"use strict";const e=require("../../../common/vendor.js");require("../../../store/modules/app.js");const o=require("../../../store/modules/device.js");require("../../../store/modules/order.js"),require("../../../store/modules/user.js");const r=require("../../../local/index.js");require("../../../hooks/uni-hooks/new-dialog.js");const s=require("../../../utils/order.js");require("../../../utils/uniAsync.js"),require("../../../utils/wx.log.js");const u=require("../../../utils/config/index.js"),i=require("../../../hooks/uni-hooks/dialog.js");require("../../../hooks/uni-hooks/request.js");const t=require("../../../hooks/uni-hooks/router.js"),n=require("../../../hooks/uni-hooks/unite.js");require("../../../hooks/uni-hooks/wechat.js"),require("../../../hooks/useCountryCode.js");const a=require("../../../hooks/use-mix.js"),d=require("../../../api/order.js"),c=require("../../../const/order.js"),l=require("../../../shared/order.js");if(require("../../../shared/pay.js"),require("../../../api/device.js"),require("../../../api/user.js"),require("../../../hooks/usePromise.js"),require("../../../api/delivery.js"),require("../../../shared/cache.js"),require("../../../const/cache.js"),require("../../../hooks/uni-hooks/cache.js"),require("../../../shared/device.js"),require("../../../const/common.js"),require("../../../utils/appEnterVerif.js"),require("../../../utils/config/env.js"),require("../../../const/platform.js"),require("../../../uni_modules/mot-utils/index.js"),require("../../../theme/hooks/useTheme.js"),require("../../../theme/hooks/themeConfig.js"),require("../../../theme/hooks/themeKeys.js"),require("../../../const/coupon.js"),require("../../../hooks/use-common.js"),require("../../../hooks/uni-hooks/loading.js"),require("../../../hooks/uni-hooks/common.js"),require("../../../utils/url.js"),require("../../../hooks/uni-hooks/report.js"),require("../../../api/data.js"),require("../../../utils/precision.js"),require("../../../hooks/useWechatSI.js"),require("../../../hooks/use-keyval/index.js"),require("../../../utils/is.js"),!Array){(e.resolveComponent("mot-button")+e.resolveComponent("mot-modal"))()}Math||((()=>"../../../uni_modules/mot-button/components/mot-button/mot-button.js")+(()=>"../../../uni_modules/mot-modal/components/mot-modal/mot-modal.js"))();const m=e.defineComponent({__name:"index",setup(m){const h=o.useDeviceStore(),j=e.ref({}),p=e.ref(c.PayPageButtomEnum.End);e.onLoad((e=>{n.unite.setNavigationBarTitle(r.t("v1_index.title"));const{orderId:o,type:s}=e||{};p.value=s,g(o)}));const q=()=>{const e=setTimeout((()=>{clearTimeout(e),t.goHome()}),1e3)},k=e=>{e.optType=p.value===c.PayPageButtomEnum.Open?c.OrderButtonEnum.Renew:c.OrderButtonEnum.RenewEnd,l.onRenew(e).then((o=>{const{data:{display_id:r},payed:s}=o;if(p.value===c.PayPageButtomEnum.Open)l.onHalfUnlock(e,!0).then((e=>{f(e)}));else{let o=`/pages/order/unlock/index?from=${c.OrderResultEnum.DONE}&orderId=${e.id}`;s>0&&(o+=`&displayId=${r}`),t.navigateTo(o)}}))},g=async e=>{try{const o=await d.lockerOrderApi.get(e,!1);j.value=o,j.value.id?j.value.is_owing?k(j.value):(i.toast(r.t("pages.common.pay.has_pay")),q()):i.dialog.showModal({content:r.t("pages.common.pay.pay_error"),showCancel:!1}).then((()=>{q()}))}catch(o){i.dialog.showModal({content:r.t("pages.common.pay.pay_error"),showCancel:!1}).then((()=>{q()}))}},f=async e=>{await h.open(e,{},{catchError:!0,homePage:!1}),t.navigateTo(`/pages/order/result/index?orderId=${e}&from=${c.OrderResultEnum.UNLOCK}`)},y=e.ref();return(o,i)=>e.e({a:j.value.id},j.value.id?{b:e.t(e.unref(r.t)("order.detail.order_no")),c:e.t(j.value.id)}:{},{d:e.unref(u.config).fileBaseUrl+"/pay/pay.png",e:e.t(e.unref(r.t)("order.detail.btn.pay_unlock")),f:e.t(e.unref(a.useToYuan)(e.unref(s.showRechargeMoney)(j.value))),g:e.t(e.unref(r.t)("pages.common.pay.button_comfirm")),h:e.o((e=>k(j.value))),i:e.p({shape:"square",isBlock:!0}),j:e.sr(y,"d35efb6c-1",{k:"ModalRef"}),k:e.p({id:"ModalRef"})})}}),h=e._export_sfc(m,[["__scopeId","data-v-d35efb6c"]]);wx.createPage(h);
