"use strict";const e=require("../../../common/vendor.js"),o=require("../../../theme/hooks/useTheme.js"),r=require("../../../local/index.js");require("../../../hooks/uni-hooks/new-dialog.js"),require("../../../store/modules/app.js");const s=require("../../../store/modules/device.js");require("../../../store/modules/order.js"),require("../../../store/modules/user.js");const i=require("../../../const/order.js");require("../../../utils/uniAsync.js"),require("../../../utils/wx.log.js"),require("../../../utils/config/index.js");const u=require("../../../hooks/uni-hooks/dialog.js");require("../../../hooks/uni-hooks/request.js");const n=require("../../../hooks/uni-hooks/router.js"),t=require("../../../hooks/uni-hooks/unite.js");require("../../../hooks/uni-hooks/wechat.js"),require("../../../hooks/useCountryCode.js");const a=require("../../../api/order.js"),d=require("../../../hooks/use-keyval/index.js"),c=require("./hook.js");if(require("../../../theme/hooks/themeConfig.js"),require("../../../theme/hooks/themeKeys.js"),require("../../../shared/cache.js"),require("../../../const/cache.js"),require("../../../hooks/uni-hooks/cache.js"),require("../../../utils/config/env.js"),require("../../../const/platform.js"),require("../../../uni_modules/mot-utils/index.js"),require("../../../api/device.js"),require("../../../api/user.js"),require("../../../hooks/usePromise.js"),require("../../../api/delivery.js"),require("../../../shared/device.js"),require("../../../const/common.js"),require("../../../utils/appEnterVerif.js"),require("../../../hooks/use-common.js"),require("../../../hooks/uni-hooks/loading.js"),require("../../../hooks/uni-hooks/common.js"),require("../../../utils/url.js"),require("../../../hooks/uni-hooks/report.js"),require("../../../api/data.js"),require("../../../const/coupon.js"),require("../../../hooks/useUpload.js"),!Array){(e.resolveComponent("uni-data-checkbox")+e.resolveComponent("uni-icons")+e.resolveComponent("uni-file-picker")+e.resolveComponent("mot-button")+e.resolveComponent("mot-modal"))()}Math||((()=>"../../../node-modules/@dcloudio/uni-ui/lib/uni-data-checkbox/uni-data-checkbox.js")+(()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../../node-modules/@dcloudio/uni-ui/lib/uni-file-picker/uni-file-picker.js")+(()=>"../../../uni_modules/mot-button/components/mot-button/mot-button.js")+(()=>"../../../uni_modules/mot-modal/components/mot-modal/mot-modal.js"))();const l=e.defineComponent({__name:"index",setup(l){const{defaultDescOptions:m,extendsDescOptions:h}=d.useKeyval(),{themeConfig:p}=o.useTheme();p.value["$primary-color"];const f=s.useDeviceStore(),q=e.ref(!0),j=e.computed((()=>q.value?m.value:[...m.value,...h.value])),k=e.computed((()=>j.value[R.value])),g=()=>{q.value=!1},v=e.reactive({checked:0,orderId:"",desc:"",fileList:[]});e.onLoad((e=>{const{orderId:o}=e||{};v.orderId=o,t.unite.setNavigationBarTitle(r.t("pages.end_storage"))}));const{selectImage:x,deleteImage:b,uploadImgsPromises:y,isHasImage:C}=c.useImageUpload(),I=async()=>{const{imageRequired:e}=k.value;if(!C(e))return;const o=await Promise.all(y());v.fileList=o,u.showModal({title:r.t("order.detail.btn.end"),content:r.t("sub-pages.order.ten.index.14"),confirmText:r.t("sub-pages.order.ten.index.9")}).then((async()=>{_()}))},_=async e=>{const{orderId:o}=v,r=w(v);if([0,4].includes(v.checked))await f.open(o,{end:!0,remark:r,reason:v.checked},{catchError:!0,homePage:!1});else{const{ErrCode:e}=await a.lockerOrderApi.end(o,{payed:0,remark:r,reason:v.checked});if(e)return}n.navigateTo(`/pages/order/result/index?orderId=${o}&from=${i.OrderResultEnum.DONE}`)},w=({checked:e,desc:o})=>{const{textValue:r}=k.value;return 4===e?`${r}:${o}`:r},{checked:R}=e.toRefs(v),B=e.ref();return(o,s)=>e.e({a:e.t(e.unref(r.t)("sub-pages.order.ten.index.1")),b:e.t(e.unref(r.t)("sub-pages.order.ten.index.3")),c:e.o((o=>e.isRef(R)?R.value=o:null)),d:e.p({localdata:e.unref(j),modelValue:e.unref(R)}),e:e.unref(q)},e.unref(q)?{f:e.t(e.unref(r.t)("sub-pages.order.ten.index.4")),g:e.p({type:"bottom",size:"16",color:"#999"}),h:e.o(g)}:{},{i:4===e.unref(R)},4===e.unref(R)?{j:e.unref(r.t)("order.question.something.placeholder"),k:e.unref(v).desc,l:e.o((o=>e.unref(v).desc=o.detail.value))}:{},{m:e.unref(k).imageRequired},e.unref(k).imageRequired?{n:e.t(e.unref(k).cameraBig),o:e.t(e.unref(k).cameraSmall),p:e.o(e.unref(x)),q:e.o(e.unref(b)),r:e.p({"file-mediatype":"image",title:e.unref(r.t)("sub-pages.order.ten.index.6"),"return-type":"array",limit:"9"})}:{},{s:e.t(e.unref(r.t)("sub-pages.order.ten.index.9")),t:e.o(I),v:e.p({shape:"square",isBlock:!0}),w:e.t(e.unref(r.t)("face.button.step2")),x:e.o((o=>e.unref(n.navigateBack)())),y:e.p({shape:"square",type:"info",isBlock:!0}),z:e.sr(B,"f43d3601-5",{k:"ModalRef"}),A:e.p({id:"ModalRef"})})}}),m=e._export_sfc(l,[["__scopeId","data-v-f43d3601"]]);wx.createPage(m);
