"use strict";const e=require("../../../../common/vendor.js"),o=require("../../../../local/index.js");require("../../../../hooks/uni-hooks/new-dialog.js"),require("../../../../store/modules/app.js");const r=require("../../../../store/modules/device.js");require("../../../../store/modules/order.js"),require("../../../../store/modules/user.js");const n=require("../../../../const/order.js");require("../../../../utils/uniAsync.js"),require("../../../../utils/wx.log.js");const t=require("../../../../utils/config/index.js"),s=require("../../../../hooks/uni-hooks/dialog.js");require("../../../../hooks/uni-hooks/request.js");const i=require("../../../../hooks/uni-hooks/router.js"),u=require("../../../../hooks/uni-hooks/unite.js");require("../../../../hooks/uni-hooks/wechat.js"),require("../../../../hooks/useCountryCode.js");const c=require("../../../../api/order.js"),a=require("../../../../hooks/use-keyval/index.js");if(require("../../../../shared/cache.js"),require("../../../../const/cache.js"),require("../../../../hooks/uni-hooks/cache.js"),require("../../../../utils/config/env.js"),require("../../../../const/platform.js"),require("../../../../uni_modules/mot-utils/index.js"),require("../../../../theme/hooks/useTheme.js"),require("../../../../theme/hooks/themeConfig.js"),require("../../../../theme/hooks/themeKeys.js"),require("../../../../api/device.js"),require("../../../../api/user.js"),require("../../../../hooks/usePromise.js"),require("../../../../api/delivery.js"),require("../../../../shared/device.js"),require("../../../../const/common.js"),require("../../../../utils/appEnterVerif.js"),require("../../../../hooks/use-common.js"),require("../../../../hooks/uni-hooks/loading.js"),require("../../../../hooks/uni-hooks/common.js"),require("../../../../utils/url.js"),require("../../../../hooks/uni-hooks/report.js"),require("../../../../api/data.js"),require("../../../../const/coupon.js"),!Array){(e.resolveComponent("mot-button")+e.resolveComponent("mot-modal"))()}Math||((()=>"../../../../uni_modules/mot-button/components/mot-button/mot-button.js")+(()=>"../../../../uni_modules/mot-modal/components/mot-modal/mot-modal.js"))();const d=e.defineComponent({__name:"index",setup(d){const{TenTypeMap:l}=a.useKeyval(),m=r.useDeviceStore(),q=e.reactive({orderId:""});e.onLoad((e=>{const{orderId:o}=e||{};q.orderId=o})),e.onShow((()=>{u.unite.setNavigationBarTitle(o.t("order.question.unlock.title"))}));const k=()=>{s.confirm(o.t("order.question.unlock.again_confirm_content"),o.t("order.question.unlock.again_confirm_title"),o.t("button.confirm"),o.t("button.cancel")).then((()=>{h()}))},h=async()=>{await m.open(q.orderId,{remark:"柜门打不开",reason:l.CanNotOpen},{catchError:!1}),s.confirm(o.t("order.question.unlock.unlock_confirm_content"),o.t("order.question.unlock.unlock_confirm_title"),o.t("order.question.unlock.unlock_confirm_btn"),o.t("order.question.unlock.unlock_confirm_cancel_btn")).then((()=>{i.reLaunch(`/pages/order/result/index?orderId=${q.orderId}&from=${n.OrderResultEnum.CREATE}`)})).catch((()=>{s.toast(o.t("order.question.unlock.unlock_cancel_toast"))}))},j=()=>{s.showModal({content:o.t("order.question.unlock.again_modal_content"),confirmText:o.t("button.confirm"),cancelText:o.t("button.cancel")}).then((()=>{p()}))},p=async()=>{const{ErrCode:e}=await c.lockerOrderApi.end(q.orderId,{payed:0,remark:"柜门打不开",reason:l.CanNotOpen});e||s.dialog.alert(o.t("order.question.unlock.end_confirm_content"),o.t("order.question.unlock.end_confirm_title"),o.t("button.confirm")).then((()=>{i.goHome()}))},f=e.ref();return(r,n)=>({a:e.unref(t.config).fileBaseUrl+"/t67.png",b:e.t(e.unref(o.t)("order.question.unlock.name")),c:e.t(e.unref(o.t)("order.question.unlock.desc")),d:e.t(e.unref(o.t)("order.question.unlock.btn_change")),e:e.o(j),f:e.p({shape:"square",isBlock:!0}),g:e.t(e.unref(o.t)("order.question.unlock.btn_again")),h:e.o(k),i:e.p({shape:"square",isBlock:!0,type:"info",plain:!0}),j:e.sr(f,"566148c7-2",{k:"ModalRef"}),k:e.p({id:"ModalRef"})})}}),l=e._export_sfc(d,[["__scopeId","data-v-566148c7"]]);wx.createPage(l);
