"use strict";const e=require("../../common/vendor.js");function t(e,t){(null==t||t>e.length)&&(t=e.length);for(var n=0,r=Array(t);n<t;n++)r[n]=e[n];return r}function n(e,t,n,r,a,o,i){try{var s=e[o](i),c=s.value}catch(u){return void n(u)}s.done?t(c):Promise.resolve(c).then(r,a)}function r(e){return function(){var t=this,r=arguments;return new Promise((function(a,o){var i=e.apply(t,r);function s(e){n(i,a,o,s,c,"next",e)}function c(e){n(i,a,o,s,c,"throw",e)}s(void 0)}))}}function a(e,t,n){return t=u(t),_(e,l()?Reflect.construct(t,n||[],u(e).constructor):t.apply(e,n))}function o(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")}function i(e,t){for(var n=0;n<t.length;n++){var r=t[n];r.enumerable=r.enumerable||!1,r.configurable=!0,"value"in r&&(r.writable=!0),Object.defineProperty(e,m(r.key),r)}}function s(e,t,n){return t&&i(e.prototype,t),n&&i(e,n),Object.defineProperty(e,"prototype",{writable:!1}),e}function c(e,t,n){return(t=m(t))in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}function u(e){return(u=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)})(e)}function p(e,t){if("function"!=typeof t&&null!==t)throw new TypeError("Super expression must either be null or a function");e.prototype=Object.create(t&&t.prototype,{constructor:{value:e,writable:!0,configurable:!0}}),Object.defineProperty(e,"prototype",{writable:!1}),t&&d(e,t)}function l(){try{var e=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){})))}catch(t){}return(l=function(){return!!e})()}function f(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,r)}return n}function g(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?f(Object(n),!0).forEach((function(t){c(e,t,n[t])})):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):f(Object(n)).forEach((function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))}))}return e}function _(e,t){if(t&&("object"==typeof t||"function"==typeof t))return t;if(void 0!==t)throw new TypeError("Derived constructors may only return object or undefined");return function(e){if(void 0===e)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return e}(e)}function h(){h=function(){return t};var e,t={},n=Object.prototype,r=n.hasOwnProperty,a=Object.defineProperty||function(e,t,n){e[t]=n.value},o="function"==typeof Symbol?Symbol:{},i=o.iterator||"@@iterator",s=o.asyncIterator||"@@asyncIterator",c=o.toStringTag||"@@toStringTag";function u(e,t,n){return Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}),e[t]}try{u({},"")}catch(M){u=function(e,t,n){return e[t]=n}}function p(e,t,n,r){var o=t&&t.prototype instanceof v?t:v,i=Object.create(o.prototype),s=new k(r||[]);return a(i,"_invoke",{value:O(e,n,s)}),i}function l(e,t,n){try{return{type:"normal",arg:e.call(t,n)}}catch(r){return{type:"throw",arg:r}}}t.wrap=p;var f="suspendedStart",g="suspendedYield",_="executing",d="completed",m={};function v(){}function y(){}function S(){}var E={};u(E,i,(function(){return this}));var A=Object.getPrototypeOf,I=A&&A(A(R([])));I&&I!==n&&r.call(I,i)&&(E=I);var P=S.prototype=v.prototype=Object.create(E);function b(e){["next","throw","return"].forEach((function(t){u(e,t,(function(e){return this._invoke(t,e)}))}))}function T(e,t){function n(a,o,i,s){var c=l(e[a],e,o);if("throw"!==c.type){var u=c.arg,p=u.value;return p&&"object"==typeof p&&r.call(p,"__await")?t.resolve(p.__await).then((function(e){n("next",e,i,s)}),(function(e){n("throw",e,i,s)})):t.resolve(p).then((function(e){u.value=e,i(u)}),(function(e){return n("throw",e,i,s)}))}s(c.arg)}var o;a(this,"_invoke",{value:function(e,r){function a(){return new t((function(t,a){n(e,r,t,a)}))}return o=o?o.then(a,a):a()}})}function O(t,n,r){var a=f;return function(o,i){if(a===_)throw Error("Generator is already running");if(a===d){if("throw"===o)throw i;return{value:e,done:!0}}for(r.method=o,r.arg=i;;){var s=r.delegate;if(s){var c=w(s,r);if(c){if(c===m)continue;return c}}if("next"===r.method)r.sent=r._sent=r.arg;else if("throw"===r.method){if(a===f)throw a=d,r.arg;r.dispatchException(r.arg)}else"return"===r.method&&r.abrupt("return",r.arg);a=_;var u=l(t,n,r);if("normal"===u.type){if(a=r.done?d:g,u.arg===m)continue;return{value:u.arg,done:r.done}}"throw"===u.type&&(a=d,r.method="throw",r.arg=u.arg)}}}function w(t,n){var r=n.method,a=t.iterator[r];if(a===e)return n.delegate=null,"throw"===r&&t.iterator.return&&(n.method="return",n.arg=e,w(t,n),"throw"===n.method)||"return"!==r&&(n.method="throw",n.arg=new TypeError("The iterator does not provide a '"+r+"' method")),m;var o=l(a,t.iterator,n.arg);if("throw"===o.type)return n.method="throw",n.arg=o.arg,n.delegate=null,m;var i=o.arg;return i?i.done?(n[t.resultName]=i.value,n.next=t.nextLoc,"return"!==n.method&&(n.method="next",n.arg=e),n.delegate=null,m):i:(n.method="throw",n.arg=new TypeError("iterator result is not an object"),n.delegate=null,m)}function C(e){var t={tryLoc:e[0]};1 in e&&(t.catchLoc=e[1]),2 in e&&(t.finallyLoc=e[2],t.afterLoc=e[3]),this.tryEntries.push(t)}function D(e){var t=e.completion||{};t.type="normal",delete t.arg,e.completion=t}function k(e){this.tryEntries=[{tryLoc:"root"}],e.forEach(C,this),this.reset(!0)}function R(t){if(t||""===t){var n=t[i];if(n)return n.call(t);if("function"==typeof t.next)return t;if(!isNaN(t.length)){var a=-1,o=function n(){for(;++a<t.length;)if(r.call(t,a))return n.value=t[a],n.done=!1,n;return n.value=e,n.done=!0,n};return o.next=o}}throw new TypeError(typeof t+" is not iterable")}return y.prototype=S,a(P,"constructor",{value:S,configurable:!0}),a(S,"constructor",{value:y,configurable:!0}),y.displayName=u(S,c,"GeneratorFunction"),t.isGeneratorFunction=function(e){var t="function"==typeof e&&e.constructor;return!!t&&(t===y||"GeneratorFunction"===(t.displayName||t.name))},t.mark=function(e){return Object.setPrototypeOf?Object.setPrototypeOf(e,S):(e.__proto__=S,u(e,c,"GeneratorFunction")),e.prototype=Object.create(P),e},t.awrap=function(e){return{__await:e}},b(T.prototype),u(T.prototype,s,(function(){return this})),t.AsyncIterator=T,t.async=function(e,n,r,a,o){void 0===o&&(o=Promise);var i=new T(p(e,n,r,a),o);return t.isGeneratorFunction(n)?i:i.next().then((function(e){return e.done?e.value:i.next()}))},b(P),u(P,c,"Generator"),u(P,i,(function(){return this})),u(P,"toString",(function(){return"[object Generator]"})),t.keys=function(e){var t=Object(e),n=[];for(var r in t)n.push(r);return n.reverse(),function e(){for(;n.length;){var r=n.pop();if(r in t)return e.value=r,e.done=!1,e}return e.done=!0,e}},t.values=R,k.prototype={constructor:k,reset:function(t){if(this.prev=0,this.next=0,this.sent=this._sent=e,this.done=!1,this.delegate=null,this.method="next",this.arg=e,this.tryEntries.forEach(D),!t)for(var n in this)"t"===n.charAt(0)&&r.call(this,n)&&!isNaN(+n.slice(1))&&(this[n]=e)},stop:function(){this.done=!0;var e=this.tryEntries[0].completion;if("throw"===e.type)throw e.arg;return this.rval},dispatchException:function(t){if(this.done)throw t;var n=this;function a(r,a){return s.type="throw",s.arg=t,n.next=r,a&&(n.method="next",n.arg=e),!!a}for(var o=this.tryEntries.length-1;o>=0;--o){var i=this.tryEntries[o],s=i.completion;if("root"===i.tryLoc)return a("end");if(i.tryLoc<=this.prev){var c=r.call(i,"catchLoc"),u=r.call(i,"finallyLoc");if(c&&u){if(this.prev<i.catchLoc)return a(i.catchLoc,!0);if(this.prev<i.finallyLoc)return a(i.finallyLoc)}else if(c){if(this.prev<i.catchLoc)return a(i.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<i.finallyLoc)return a(i.finallyLoc)}}}},abrupt:function(e,t){for(var n=this.tryEntries.length-1;n>=0;--n){var a=this.tryEntries[n];if(a.tryLoc<=this.prev&&r.call(a,"finallyLoc")&&this.prev<a.finallyLoc){var o=a;break}}o&&("break"===e||"continue"===e)&&o.tryLoc<=t&&t<=o.finallyLoc&&(o=null);var i=o?o.completion:{};return i.type=e,i.arg=t,o?(this.method="next",this.next=o.finallyLoc,m):this.complete(i)},complete:function(e,t){if("throw"===e.type)throw e.arg;return"break"===e.type||"continue"===e.type?this.next=e.arg:"return"===e.type?(this.rval=this.arg=e.arg,this.method="return",this.next="end"):"normal"===e.type&&t&&(this.next=t),m},finish:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.finallyLoc===e)return this.complete(n.completion,n.afterLoc),D(n),m}},catch:function(e){for(var t=this.tryEntries.length-1;t>=0;--t){var n=this.tryEntries[t];if(n.tryLoc===e){var r=n.completion;if("throw"===r.type){var a=r.arg;D(n)}return a}}throw Error("illegal catch attempt")},delegateYield:function(t,n,r){return this.delegate={iterator:R(t),resultName:n,nextLoc:r},"next"===this.method&&(this.arg=e),m}},t}function d(e,t){return(d=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(e,t){return e.__proto__=t,e})(e,t)}function m(e){var t=function(e,t){if("object"!=typeof e||!e)return e;var n=e[Symbol.toPrimitive];if(void 0!==n){var r=n.call(e,"string");if("object"!=typeof r)return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(e)}(e);return"symbol"==typeof t?t:t+""}function v(e){return(v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(e){return typeof e}:function(e){return e&&"function"==typeof Symbol&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e})(e)}function y(e,t){if(e)if(P(e)&&void 0===e.length)for(var n in e)Object.prototype.hasOwnProperty.call(e,n)&&t(n,e[n],e);else{var r,a=e.length;for(r=0;r<a&&"break"!==t(e[r],r);r++);}}function S(e){return Array.isArray?Array.isArray(e):/Array/.test(Object.prototype.toString.call(e))}var E={isArray:S,indexOf:function(e,t){var n=-1;try{n=e.indexOf(t)}catch(a){for(var r=0;r<e.length;r++)e[r]===t&&(n=r)}finally{return n}},itemMatch:function(e,t){var n=!1;try{if(!this.isArray(e))return n;n=e.some((function(e){return e&&e.length>0&&-1!==t.indexOf(e)}))}catch(a){for(var r=0;r<e.length;r++)if(-1!==t.indexOf(e[r])){n=!0;break}}return n},find:function(e,t){try{return e.find(t)}catch(r){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}},flat:function e(t){var n=[];if(S(t))for(var r=0;r<t.length;r++){var a=t[r];S(a)?(t[r]=e(a),n=n.concat(t[r])):n.push(a)}return n},assign:A,some:function(e,t){var n,r=e.length;for(n=0;n<r;n++)if(t(e[n]))return!0;return!1},each:y};function A(e,t){return"function"!=typeof Object.assign?function(e){for(var t=Object(e),n=1;n<arguments.length;n++){var r=arguments[n];if(null!==r)for(var a in r)Object.prototype.hasOwnProperty.call(r,a)&&(t[a]=r[a])}return t}(e,t):Object.assign({},e,t)}function I(e){var t,n=Array.isArray(e)?[]:{};if("object"===v(e)){if(JSON&&JSON.parse)t=JSON.stringify(e),n=JSON.parse(t);else for(var r in e)n[r]="object"===v(e[r])?I(e[r]):e[r];return n}}function P(e){if("object"!==v(e)||null===e)return!1;for(var t=e;null!==Object.getPrototypeOf(t);)t=Object.getPrototypeOf(t);return Object.getPrototypeOf(e)===t}var b={isObject:P,assign:A,cloneDeep:I,isEmptyObject:function(e){try{if(!e)return!0;if("function"==typeof Object.keys&&0===Object.keys(e).length)return!0;for(var t in e)if(Object.prototype.hasOwnProperty.call(e,t))return!1;return!0}catch(n){return!1}},each:y,eachMap:function(e,t){if(Object&&Object.keys)for(var n=Object.keys(e),r=n.length,a=0;a<r;a++){var o=n[a];t(o,e[o])}else for(var i in e)t(i,e[i])},deleteKeys:function(e,t){return y(t,(function(t){delete e[t]})),e}},T=function(e){return"number"==typeof e},O=function(e){if(e)try{return JSON.stringify(e)}catch(t){}return""},w=function(e){if(e)try{return JSON.parse(e)}catch(t){}return null},C=function(e){if(!e||"string"!=typeof e)return{};for(var t=e.replace(/['"{}]+/g,"").split(","),n=[],r=0;r<t.length;r++)n.push(t[r].split(":"));return R(n)};function D(e){return"function"==typeof e}function k(e){return void 0===e}function R(e){var t,n,r,a={},o=e.length;for(r=0;r<o;r++)t=e[r][0]&&e[r][0].trim(),n=e[r][1],a[t]=n;return a}function M(e){if("object"===v(e))return e;var t={};if(!e||"string"!=typeof e)return t;for(var n=e.split("&"),r=0;r<n.length;r++){var a=n[r],o=a.indexOf("="),i=a.split("="),s=a.length;if(2===i.length)t[i[0]]=i[1]||"";else if(o>0){var c=a.slice(0,o),u=a.slice(o+1,s)||"";t[c]=u}else t[i[0]]=""}return t}var N="::-plain-::";function x(e,t){var n,r,a,o=[];for(n in e)n&&Object.prototype.hasOwnProperty.call(e,n)&&(a="object"===v(e[n])?r=""+this.obj2queryStr(e[n]):n+"="+(r=""+e[n]),t?o.push(a):o.push(0===n.indexOf(N)?r:a));return o.join("&")}function L(e){for(var t,n=e.split("&"),r=0,a=n.length,o=[];r<a;r++)t=n[r].split("="),o.push([t.shift(),t.join("=")]);return o}var U={isString:function(e){return"[object String]"===Object.prototype.toString.call(e)},isStartWith:function(e,t){return!(!e||!t||0===t.length||t.length>e.length)&&0===e.indexOf(t)},isEndWith:function(e,t){if(String.prototype.endsWith)return e.endsWith(t);var n=e.length,r=t.length;return n>=r&&e.substring(n-r)===t},isContain:function(e,t){return e.indexOf(t)>-1},getRandomStr:function(e){for(var t="",n=["0","1","2","3","4","5","6","7","8","9","a","b","c","d","e","f","g","h","i","j","k","l","m","n","o","p","q","r","s","t","u","v","w","x","y","z","A","B","C","D","E","F","G","H","I","J","K","L","M","N","O","P","Q","R","S","T","U","V","W","X","Y","Z"],r=0;r<Number(e);r++)t+=n[Math.round(Math.random()*(n.length-1))];return t},trim:function(e){return"string"==typeof e?e.replace(/^\s+|\s+$/g,""):""},query2obj:M},j={query2obj:M,arr2obj:R,arr2queryStr:function(e,t){var n,r,a,o=[],i=e.length;for(a=0;a<i;a++){n=e[a][0],r=e[a][1];var s=0===n.indexOf(N),c=s||t?r:encodeURIComponent(r);o.push(s?c:n+"="+c)}return o.join("&")},obj2queryStr:x},B=function(){var e=null,t=!1,n="";function r(){this.setDebug=function(e,r){t=e,n=r?"[APLUS] -- ":"[QT] -- "},this.i=function(){if(t)try{"string"==typeof arguments[0]&&(arguments[0]=n+arguments[0]),console.info.apply(console,arguments)}catch(e){}},this.e=function(){if(t)try{"string"==typeof arguments[0]&&(arguments[0]=n+arguments[0]),console.error.apply(console,arguments)}catch(e){}},this.w=function(){if(t)try{"string"==typeof arguments[0]&&(arguments[0]=n+arguments[0]),console.warn.apply(console,arguments)}catch(e){}},this.v=function(){try{"string"==typeof arguments[0]&&(arguments[0]=n+arguments[0]),console.warn.apply(console,arguments)}catch(e){}},this.tip_w=function(e){try{console.log("%c "+n+e,"background:red; padding: 4px; padding-right: 8px; border-radius: 4px; color: #fff;")}catch(t){}},this.repeat=function(e){for(var t=e;t.length<86;)t+=e;return t}}return function(){return null===e&&(e=new r),e}}();function F(){}F.prototype.extend=function(){},F.prototype.create=function(){},F.extend=function(e){return this.prototype.extend.call(this,e)},F.prototype.create=function(e){var t=new this;for(var n in e)t[n]=e[n];return t},F.prototype.extend=function(e){var t=function(){};try{for(var n in D(Object.create)||(Object.create=function(e){function t(){}return t.prototype=e,new t}),t.prototype=Object.create(this.prototype),e)t.prototype[n]=e[n];t.prototype.constructor=t,t.extend=t.prototype.extend,t.create=t.prototype.create}catch(r){B&&B().w(r)}finally{return t}};var K,V=F.extend({create:function(e,t){var n=t.apiName,r=t.queueName,a=new this;return a._sdkApiName=n,a._sdkQueueName=r,e[n]=e[n]||(e[n]={}),e[r]=e[r]||(e[r]=[]),a.ctx=e,a},getSdkApiName:function(){return this._sdkApiName},getSdkQueueName:function(){return this._sdkQueueName},setContextValue:function(e,t){this.ctx[this._sdkApiName]&&(this.ctx[this._sdkApiName][e]=t)},getContextValue:function(e){var t;return this.ctx[this._sdkApiName]&&(t=this.ctx[this._sdkApiName][e]),!t&&this.ctx.goldlog&&(t=this.ctx.goldlog[e]),t}});function $(){return K}function q(){return $().getSdkApiName()}function G(){return $().getSdkQueueName()}function H(e){return $().ctx[e]}function Y(e,t){$().ctx[e]=t}function Q(e){return $().getContextValue(e)}function W(e,t){$().setContextValue(e,t)}var z="function",J=function(){var e=H(q())[q()+"_pubsub"]||{};return v(e.publish)===z?e:""};function X(e){var t=J();t&&v(t.publish)===z&&t.publish.apply(t,e)}function Z(e){var t=J();t&&v(t.cachePubs)===z&&t.cachePubs.apply(t,e)}var ee=E.indexOf;function te(){}function ne(){return{init:function(e){this.opts=e,e&&"object"===v(e.middleware)&&e.middleware.length>0?this.middleware=e.middleware:this.middleware=[],this.plugins_name=[]},pubsubInfo:function(e,t){try{var n=e.pubsub;n&&n.publish("plugins_change_"+e.pubsubType,t)}catch(r){console.log(r)}},isConstructor:function(e){var t=!0;try{new e}catch(n){t=!1}return t},run:function(e){e||(e=0);var t=this,n=this.middleware,r=this.opts||{},a=r.plugins;if(a&&"object"===v(a)&&a.length>0){var o=a[e];if(this.plugins_name.push(o.name),n.push([function(e,n){var a;if(t.pubsubInfo(this,o),o.path&&t.isConstructor(o.path)?a=o.path:o.path.default&&t.isConstructor(o.path.default)&&(a=o.path.default),a){var i=new a({context:this.context,config:A(o.config||{},r.config)});return i.options||(i.init||(i.init=function(e){this.options=e}),i.init({context:this.context,config:A(o.config||{},r.config)})),i.run(e,(function(e){setTimeout((function(){n(o,e)}),1)}))}},o.name]),a[++e])return this.run(e)}return n}}}te.prototype.create=function(e){for(var t in e)void 0===this[t]&&(this[t]=e[t]);return this},te.prototype.calledList=[],te.prototype.setCalledList=function(e){-1===ee(this.calledList,e)&&this.calledList.push(e)},te.prototype.resetCalledList=function(){this.calledList=[]},te.prototype.wrap=function(e,t){var n=this,r=((this.context||{}).Compose||{}).maxTimeout||1e4;return function(a){var o,i=e.length,s=0,c=0,u=function(p,l){if(s!==i){if(-1===ee(n.calledList,s)){if(n.setCalledList&&n.setCalledList(s),!(e&&e[s]&&D(e[s][0])))return;try{a=e[s][0].call(n,a,(function(){s++,c=1,u(s)}))}catch(h){console.log(h)}}var f="number"==typeof a;if("pause"===a||f){c=0;var g=f?a:r,_=e[s]?e[s][1]:"";o=setTimeout((function(){0===c&&(B().w("jump the middleware about "+_+", because waiting timeout maxTimeout = "+g),a=null,s++,u())}),g)}else"done"===a?u(s=i,a):(s++,u())}else a="done",n.resetCalledList(),D(t)&&l!==a&&t.call(n,a),clearTimeout(o)};return n.calledList&&n.calledList.length>0&&n.resetCalledList(),u()}};var re=function(){};re.prototype.run=function(e,t,n){var r=new ne;r.init({middleware:[],config:t.config,plugins:e.plugins});var a=r.run(),o=D(e.context)?new e.context:e.context;o.userdata=t.userdata;var i={context:o,pubsub:Q(q()+"_pubsub"),pubsubType:t&&t.pubsubType},s=new te;s.create(i),s.wrap(a,(function(){i.context.status="complete",t&&(t.middlewareMessageKey&&X([t.middlewareMessageKey,i.context]),t.messageFnQueue&&y(t.messageFnQueue,(function(t){t(getGlobalValue(q()),e)}))),D(n)&&n(i.context)}))()};var ae,oe,ie,se="mw_change",ce="MetaInfo",ue="append".concat(ce),pe="set".concat(ce),le="_pubsub",fe="2101",ge="2201",_e="19999",he="aplus",de={PAGE_ENTER:"PAGE_ENTER",CURRENT_PAGE_CONFIG:"CURRENT_PAGE_CONFIG",_ANONY_ID:"_anony_id",_DEV_ID:"_dev_id",_CNA:"cna",_browerFP:"_abfpc",_USER_ID:"_user_id",UNSUBSCRIBE:"".concat(he,".").concat(he).concat(le,".unsubscribe"),SUBSCRIBE:"".concat(he,".").concat(he).concat(le,".subscribe"),PUBLISH:"".concat(he,".").concat(he).concat(le,".publish"),CACHE_PUBS:"".concat(he,".").concat(he).concat(le,".cachePubs"),SDK_READY:"".concat(he,"Ready"),SDK_PUB:"".concat(he).concat(le),COMPLETE:"complete",PV_CODE:"2001",EXP_CODE:ge,CLK_CODE:fe,OTHER_CODE:_e,CLK:"CLK",EXP:"EXP",OTHER:"OTHER",SPM_CNT:"spm-cnt",SPM_URL:"spm-url",SPM_PRE:"spm-pre",MW_CHANGE_PV:"".concat(se,"_pv"),MW_CHANGE_HJLJ:"".concat(se,"_hjlj"),HTTP:"".concat("http",":"),HTTPS:"https:",APPEND_META_INFO:ue,SET_META_INFO:pe,SDK_APPEND_META_INFO:"".concat(he,".").concat(ue),SDK_SET_META_INFO:"".concat(he,".").concat(pe),PVID:"pvid",WEB_PC_PV_SUFFIX:"v.gif",WEB_WAP_PV_SUFFIX:"m.gif",NATIVE_TRANSP_READY:"".concat(he,"NativeTranspReady")},me=["send","enter","sendPV","record","combineRecord","recordUdata","requestVTConfig","requestRemoteConfig","setPageSPM","setMetaInfo","appendMetaInfo","updatePageProperties","updateNextPageProperties","updatePageUtparam","updateNextPageUtparam","pageAppear","pageDisappear","skipPage","updateSessionProperties","getPageSpmUrl","getPageSpmPre","setPageName","getElementSPM","recordAppLink","onPageShow","onPageHide","reportUserInfo"],ve={EXP:ge,IMPEXP:"2202",CLK:fe,OTHER:_e,SHOW:"1023",H_OR_U:"1010"},ye={ekvs:"e",active_user:"active_user"},Se=(g(g({},ye),{},{sessions:"sn"}),{sdk_type:"sdt",device_model:"dm",language:"lang",device_type:"dt",os_version:"ov",appkey:"ak",sdk_version:"sv",resolution:"rl",pixel_ratio:"pr",_id:"id",id_type:"it",id_tracking:"itr"}),Ee=(g(g({},Se),{},{imprint:"imp",debugId:"dk"}),g(g({},Se),{},{access:"ac",access_subtype:"acs",device_manufacturer:"dmf",device_name:"dn",platform_version:"pv",font_size_setting:"fss",device_manuid:"did",platform_sdk_version:"psv",device_brand:"db",imprint:"imp",miniappDebugId:"dk"})),Ae={uuid:"ud",unionid:"und",openid:"od",anonymousid:"nd",alipay_id:"ad",device_id:"dd",userid:"puid"},Ie={APLUS:he,APPKEY:"appKey",APLUS_PV_DOMAIN:"aplus-rhost-v",APLUS_EKV_DOMAIN:"aplus-rhost-g",SESSION_INTERVAL:3e4,PAGE_SCROLL_DURATION:4e3,SESSION_PAUSE_TIME:"session_pause_time",IMPRINT:"imprint",CURRENT_SESSION:"current_session",MAX_EVENTID_LENGTH:128,MAX_PROPERTY_KEY_LENGTH:256,MAX_PROPERTY_KEYS_COUNT:100,FAILED_REQUESTS:"failed_requests",REQUESTS:"requests",SHARES:"shares",EKVS:"ekvs",EVENT_MAX_COUNT:1e4,MEMORY_MAX_COUNT:1,MAX_QUEUE_COUNT:1,EVENT_SEND_DEFAULT_INTERVAL:3e3,PAGE_START:"$$_page_start",PAGE_END:"$$_page_end",APP_START:"$$_app_start",APP_END:"$$_app_end",PULL_DOWN_REFRESH:"$$_pull_down_refresh",REACH_BOTTOM:"$$_reach_bottom",SHARE:"$$_share",ADD_TO_FAVORITE:"$$_addtofavorite",REF_SHARE_ID:"$$_ref_share_id",REF_SHARE_URL:"$$_ref_share_url",USER_PROFILE:"$$_user_profile",SHARE_CACHE_INTERVAL:18e5,GLOBAL_PROPERTY:"globalproperty",JSBRIDGE_ONLY:"aplus-jsbridge-only",JSBRIDGE_AGENT:"Umeng4Aplus",APLUS_SKIP_APV_RULES:"aplus-skip-apv-rules",APLUS_IMPRINT_VERSION:"APLUS_IMPRINT_VERSION",APLUS_REMOTE_CONFIG:"APLUS_REMOTE_CONFIG",WEB_EVENT_SUFFIX:"/web_logs",PAGE_LEAVE:"$$_page_leave",PAGE_STAY:"$$_page_stay",APLUS_AUTOTRACK_ENABLED:"aplus-autotrack-enabled",APLUS_AUTOTRACK_ENABLED_REMOTE:"apus-autotrack-enabled-remote",APLUS_AUTOTRACK_CONFIG:"aplus-autotrack-config",APLUS_AUTOTRACK_CONFIG_REMOTE:"aplus-autotrack-config-remote",APLUS_DISABLE_AUTOEVENT:"aplus-disable-autoevent",APLUS_DISABLE_AUTOEVENT_REMOTE:"aplus-disable-autoevent",APLUS_DISABLE_AUTOPV:"aplus-disable-apv",APLUS_DISABLE_AUTOPV_REMOTE:"aplus-disable-apv-remote",APLUS_EVENT_LIMITRATES:"aplus-event-limitrates",APLUS_DEVICE_ENABLE:"aplus-device-enable",PERFORMANCE_WARING:"$$_perf_warning",START_ID:"START_ID",AUTO_GET_OPENID:"autoGetOpenid",TRACKDOMAIN:"trackDomain",APLUS_MINI_REQUEST_TIMEOUT:"aplus-request-timeout",APLUS_LATEAST_UTM:"APLUS_LATEAST_UTM",APLUS_FORWARD_APPKEY:"aplus-forward-appkey",APLUS_FORWARD_DOMAIN:"aplus-forward-domain",APLUS_FORWARD_EVENT_FILTER:"aplus-forward-event-filter",CNA_SYNC_READY:"cnaSyncReady",PAGE_CONFIG:"pageConfig",APLUS_VT_CONFIG_URL:"aplus-vt-cfg-url",APLUS_EXPOSURE_EVENT_CAN_REPEAT:"aplus-exposure-event-can-repeat",APLUS_MINI_REQUESTS_LIMIT:"aplus-mini-requests-limit",DEBUG:"DEBUG",APLUS_UTM_EXPIRE_DAYS:"aplus-utm-expire-days",APLUS_PAGEVIEW_DURATION_CAN_TRACK:"aplus-pageview-duration-can-track",APLUS_PRESET_EVENTS_DISABLED:"aplus-preset-events-disabled",APLUS_GLOBALPROPERTY_SYNC_ENABLE:"aplus-globalproperty-sync-enable",APLUS_NEXT_PAGE_TRANSP:"aplus-nextpage-properties",APLUS_LOCALSTORE_PAGE_TRANSP:"aplus-native-page-properties",APLUS_CALLBACK:"qtCallback",START_TIME:"start_time",DEFAULT_REQUEST_TIMEOUT:3e3,APLUS_SDK_DISABLE:"aplus-sdk-disable"},Pe={record:"".concat(he,".record"),sendPV:"".concat(he,".sendPV"),setMetaInfo:"".concat(he,".setMetaInfo"),appendMetaInfo:"".concat(he,".appendMetaInfo")},be="ekv",Te=Object.freeze({OK:200,MULTIPLE_CHOICES:300,MOVED_PERMANENTLY:301,FOUND:302,BAD_REQUEST:400,NOT_FOUND:404,SERVER_ERROR:500}),Oe=Object.freeze({GET:"GET",POST:"POST",PUT:"PUT",DELETE:"DELETE",WebSocket:"WS",WebSocketOnly:"WS-ONLY"}),we=Object.freeze({codelessCollectorPageStatus:"codelessCollectorPageStatus",currentDeviceEnable:"currentDeviceEnable",codelessClickEventStatus:"codelessClickEventStatus",codelessStatus:"codelessStatus",codelessIgnoreComponent:"codelessIgnoreComponent"}),Ce=function(e,t){var n=H(G()),r=H(q()),a=e.split("."),o=r[a[1]],i=o?o[a[2]]:null;r&&2===a.length&&o?o.apply(r,t):3===a.length&&i?i.apply(o,t):n.push({action:e,arguments:t})};function De(e,t){return e&&e.getAttribute&&e.getAttribute(t)||""}function ke(e){try{return localStorage.getItem(e)}catch(t){return""}}function Re(e){return ae=ae||document.getElementsByTagName("head")[0],ie&&!e?ie:ae?ie=ae.getElementsByTagName("meta"):[]}function Me(e,t){var n="aplus&sidx=aplusSidex&ckx=aplusCkx",r=e||n;try{if(t){var a=M(t),o=[Ie.APLUS,"cna",de.SPM_CNT,de.SPM_URL,de.SPM_PRE,"logtype","pre","uidaplus","asid","sidx","trid","gokey"];E.each(o,(function(e){Object.prototype.hasOwnProperty.call(a,e)&&(B().w("Can not inject keywords: ".concat(e)),delete a[e])})),delete a[""];var i="";if(e){var s=e.match(/aplus&/).index,c=s>0?M(e.substring(0,s)):{};delete c[""],i="".concat(x(b.assign(c,a)),"&").concat(e.substring(s,e.length))}else i="".concat(x(a),"&").concat(n);return i}return r}catch(u){return r}}function Ne(){var e,t=Me(De((oe||(oe=document.getElementById("beacon-aplus")||document.getElementById("tb-beacon-aplus")),oe),"exparams"),(((e=H(q()))&&e._$?e._$:{}).meta_info||{})["aplus-exparams"]||"")||"";return t&&t.replace(/&amp;/g,"&").replace(/\buser(i|I)d=/,"uidaplus=")}var xe={set:function(e,t){try{return localStorage.setItem(e,t),!0}catch(n){return!1}},get:ke,test:function(){var e="grey_test_key";try{return localStorage.setItem(e,1),localStorage.removeItem(e),!0}catch(t){return!1}},remove:function(e){try{return localStorage.removeItem(e),!0}catch(t){return!1}},getLocalStorageFP:function(){var e,t=ke(de._browerFP);return t&&(e=t.split("_")[0]),e}},Le=function(e,t){var n=t||"";if(e)try{n=decodeURIComponent(e)}catch(r){}return n},Ue={getMetaTags:Re,getMetaCnt:function(e,t){var n,r,a,o=Re(),i=o.length;for(n=0;n<i;n++)De(r=o[n],"name")===e&&(a=De(r,t||"content"));return a||""},mergeExparams:Me,getExParams:Ne,getExparamsInfos:function(e,t){for(var n={},r=e||["uidaplus","pc_i","pu_i"],a=Ne()||"",o=L(a=a.replace(/&aplus&/,"&"))||[],i=0;i<o.length;i++){var s=o[i],c=s[0]||"",u=s[1]||"";c&&u&&("EXPARAMS"===t||(p=c,E.indexOf(r,p)>-1))&&(n[c]=u)}var p;return n}},je=0,Be={},Fe={getStartId:function(){return U.getRandomStr(10)+Date.now()+U.getRandomStr(9)},getUUID:function(){return U.getRandomStr(10)+Date.now()+U.getRandomStr(9)},fixDomain:function(e){return-1!==e.indexOf("https://")||-1!==e.indexOf("http://")?e:(e=(/^\/\//.test(e)?"":"//")+e,/(\d+\.){3,}\d+/.test(e)?de.HTTP+e:de.HTTPS+e)},getAppKey:function(){var e=H(q());return e.getMetaInfo("appkey")||e.getMetaInfo("appId")||e.getMetaInfo("appKey")},getTrackDomain:function(){var e=H(q());return e.getMetaInfo(Ie.APLUS_PV_DOMAIN)||e.getMetaInfo(Ie.TRACKDOMAIN)},checkDomain:function(e,t){var n=new RegExp(/^((http|https|''):\/\/)?([a-zA-Z0-9][-a-zA-Z0-9]{0,62}(\.[a-zA-Z0-9][-a-zA-Z0-9]{0,62})+(:[0-9]{1,5})*)(\/.*)?$/),r=((e||"").match(n)||[])[0];return!(!e||!r)||(B().tip_w(B().repeat("!")),B().tip_w("trackDomain error, please check ".concat(t," setting, current value is: ").concat(e)||"undefined"),B().tip_w("we accept these three patterns:"),B().tip_w("eg1: https://test-qtracking-xxx.com:port/a/b/c, port is optional"),B().tip_w("eg2: http://test-qtracking-xxx.com:port/a/b/c, port is optional"),B().tip_w("eg3: test-qtracking-xxx.com:port/a/b/c, port is optional"),B().tip_w(B().repeat("!")),!1)},checkOpenid:function(e){return!!e||(B().tip_w(B().repeat("!")),B().tip_w("QT need an unique id as QT's deviceid!!"),B().tip_w("setting examples: aplus_queue.push({action: '".concat(q(),".setMetaInfo', arguments: ['_anony_id', xxxxxx]});")),B().tip_w("referrence document: https://t.tb.cn/1dTHjTTQF0UjOTNHiCkaCS"),B().tip_w(B().repeat("!")),!1)},checkEvent:function(e,t){if(!e||"string"!=typeof e)return B().w("event logkey is invalid, id =",e||"'' event properties = ",O(t.cusp)),!1;var n=["id","du"],r={};if(n.forEach((function(e){r[e]=1})),r[e])return B().e("eventId has conflict with reservewords: ".concat(n.join(","))),!1;if(e.length>Ie.MAX_EVENTID_LENGTH)return B().e("The maximum length of event id shall not exceed ".concat(Ie.MAX_EVENTID_LENGTH)),!1;if(t&&("object"!==v(t)||E.isArray(t))&&"string"!=typeof t)return B().e("please check trackEvent properties. properties should be string or object(not include Array)"),!1;if("object"===v(t)){var a=0;for(var o in t)if(Object.prototype.hasOwnProperty.call(t,o)){if(o.length>Ie.MAX_PROPERTY_KEY_LENGTH)return B().e("The maximum length of property key shall not exceed ".concat(Ie.MAX_PROPERTY_KEY_LENGTH)),!1;if(a>=Ie.MAX_PROPERTY_KEYS_COUNT)return B().e("The maximum count of properties shall not exceed ".concat(Ie.MAX_PROPERTY_KEYS_COUNT)),!1;if(r[o])return B().e("property key has conflict with reserveWords: ".concat(n.join(","))),!1;a+=1}}return!0},rank:function(){return je++,Object.prototype.hasOwnProperty.call(Be,je)?je++:Be[je]=je,je},clear:function(){je=0,Be={}},zeroFill:function(e,t,n){var r="".concat(Math.abs(e)),a=t-r.length,o=e>=0,i=Math.pow(10,Math.max(0,a)).toString().substring(1)+r;return o?(n?"+":"")+i:"-".concat(i)},date2YYMMDD:function(e){try{var t=new Date;return[t.getFullYear(),this.zeroFill(t.getMonth()+1,2,0),this.zeroFill(t.getDate(),2,0)].join(e||"")}catch(n){return""}},date2YYMMDDHHMMSS:function(e){try{var t=new Date;return[t.getFullYear(),this.zeroFill(t.getMonth()+1,2,0),this.zeroFill(t.getDate(),2,0),this.zeroFill(t.getHours(),2,0),this.zeroFill(t.getMinutes(),2,0),this.zeroFill(t.getSeconds(),2,0)].join(e||"")}catch(n){return""}},mapEventSampleRates:function(e){var t=[];return y(e,(function(e){e.eventIds&&e.eventIds.length>0&&y(e.eventIds,(function(n){t.push({eventId:n,samplingRate:e.samplingRate})}))})),t},hash:function(e,t){var n,r=t||1315423911;for(n=e.length-1;n>=0;n--)r^=(r<<5)+e.charCodeAt(n)+(r>>2);for(var a=(2147483647&r).toString(16);a.length<8;)a+="0";return a},isDebug:function(){var e=!1,t=H(q());try{e=/debugMode=true/.test(location.href)||t.getMetaInfo("DEBUG")}catch(n){}return e},localAutoEventDisabled:function(){return!!H(q()).getMetaInfo(Ie.APLUS_DISABLE_AUTOEVENT)},localAutoPVDisabled:function(){var e=H(q()),t=e.getMetaInfo(Ie.APLUS_DISABLE_AUTOPV);return"string"==typeof t&&""===t?!(!e._$.meta_info[Ie.APLUS_DISABLE_AUTOPV]&&"MAN"!==e._$.meta_info["aplus-waiting"]):!(!e.getMetaInfo(Ie.APLUS_DISABLE_AUTOPV)&&"MAN"!==e.getMetaInfo("aplus-waiting"))},getAutoTrackStatus:function(){return!!H(q()).getMetaInfo(Ie.APLUS_AUTOTRACK_ENABLED)},semicolonStr2Obj:function(e,t,n){t=t||{};var r,a,o=e.split(";"),i=o.length;for(a=0;a<i;a++){r=o[a].split("=");var s=U.trim(r.slice(1).join("="));t[U.trim(r[0])||""]=n?s:Le(s)}return t},getEtagUrl:function(e){var t=H(q()),n=e;try{var r=t.getMetaInfo(Ie.APLUS_PV_DOMAIN);r=this.fixDomain(r),n="".concat(r,"/eg.js")}catch(a){}return n},getImprintFromStorage:function(e){if(xe.get&&xe.test()){var t="",n=xe.get(e);if(n){var r=n.split("||")||[];t=r.length>1&&r[1]}return decodeURIComponent(t)}return""},setImprintToStorage:function(e,t){t&&xe.set&&xe.test()&&xe.set(e,"".concat(this.date2YYMMDDHHMMSS(),"||").concat(encodeURIComponent(t)))},setRemoteConfigToStorage:function(e,t){if(t&&xe.set&&xe.test()){var n=b.cloneDeep(t);"object"===v(n)&&(n=JSON.stringify(n)),xe.set(e,"".concat(this.date2YYMMDDHHMMSS(),"||").concat(encodeURIComponent(n)))}},getRemoteConfigFromStorage:function(e){if(xe.get&&xe.test()){var t="",n=xe.get(e);if(n){var r=n.split("||")||[];t=r.length>1&&r[1]}return w(decodeURIComponent(t))}return""},setCnaToStorage:function(e,t,n){n&&xe.set&&xe.test()&&xe.set(e,"".concat(t,"_").concat(encodeURIComponent(n)))},getCnaFromStorage:function(e,t){if(xe.get&&xe.test()){var n="",r=xe.get(e);if(r){var a=r.split("_")||[];n=t?a.length>1&&t===a[0]?a[1]:"":a.length>1?a[1]:""}return decodeURIComponent(n)}return""},deleteInfo:function(e,t){return y(t,(function(t){delete e[t]})),e},resetFn:function(){var e=arguments.length>0&&arguments[0]?arguments[0]:{},t=arguments.length>1&&arguments[1]?arguments[1]:"",n=arguments.length>2&&arguments[2]?arguments[2]:function(){},r=e[t];e[t]=function(){var e=r&&r.apply(this,arguments);return e?n.call(this,e):n.apply(this,arguments)}},rewriteFn:function(e,t,n){var r=e[t];e[t]=function(e){n.call(this,e),r&&r.call(this,e)}},getHashKey:function(e,t){var n=[t.logkey,t.cssSelector];return t.positionSelector&&n.push(t.positionSelector),e.id&&n.push(e.id),e.index>=0&&n.push(e.index),e.dataset&&e.dataset.privateNodeId&&delete e.dataset.privateNodeId,e.dataset&&n.push(JSON.stringify(e.dataset)),n.join("_")},getTimeZone:function(){var e=-(new Date).getTimezoneOffset()/60;return Math.abs(parseInt(e,10))},convertNativeMapStringToJSON:function(e){var t=e.replace(/(\w+)=([^,]+)/g,'"$1":"$2"').replace(/[{}]/g,""),n="{".concat(t,"}");return JSON.parse(n)}},Ke={rank:Fe.rank,clear:Fe.clear},Ve={localAutoEventDisabled:Fe.localAutoEventDisabled,localAutoPVDisabled:Fe.localAutoPVDisabled,getAutoTrackStatus:Fe.getAutoTrackStatus},$e={set:Fe.setRemoteConfigToStorage,get:Fe.getRemoteConfigFromStorage},qe={set:Fe.setImprintToStorage,get:Fe.getImprintFromStorage},Ge={set:Fe.setCnaToStorage,get:Fe.getCnaFromStorage},He={resetFn:Fe.resetFn,rewriteFn:Fe.rewriteFn};Fe.LocalCfgUtils=Ve,Fe.RemoteCfgUtils=$e,Fe.CNAUtils=Ge,Fe.ImprintUtils=qe,Fe.AccessType={MOBILE_NETWORK_2G:"2g",MOBILE_NETWORK_3G:"3g",MOBILE_NETWORK_4G:"4g",MOBILE_NETWORK_NONE:"none"},Fe.FunctionUtils=He,Fe.RankUtils=Ke;var Ye,Qe=["$sid"],We="httpRequest",ze="request",Je=function(){},Xe=Object.freeze({WECHAT:"wx",DINGTALK:"dd",ALIPAY:"my",TAOBAO:"taobao",TIKTOK:"tt",BAIDU:"bd",JD:"jd",XHS:"xhs",UNKNOW:"UNKNOW"});function Ze(){try{return{ctx:dd,platType:Xe.DINGTALK,sdkType:"ddmp",logDomain:"/ddm_logs"}}catch(dt){try{return{ctx:my,platType:my&&my.tb?Xe.TAOBAO:Xe.ALIPAY,sdkType:my&&my.tb?"taobaomp":"mymp",logDomain:"/alipaym_logs"}}catch(t){try{return{ctx:tt,platType:Xe.TIKTOK,sdkType:"ttmp",logDomain:"/bytedancem_logs"}}catch(n){try{return{ctx:swan,platType:Xe.BAIDU,sdkType:"bdmp",logDomain:"/baidum_logs"}}catch(r){try{return{ctx:xhs,platType:"xhs",sdkType:"xhsmp",logDomain:"/wxm_logs"}}catch(a){try{return{ctx:e.wx$1,platType:"wx",sdkType:"wxmp",logDomain:"/wxm_logs"}}catch(o){try{return{ctx:jd,platType:Xe.JD,sdkType:"jdmp",logDomain:"/wxm_logs"}}catch(i){return{ctx:{},platType:Xe.UNKNOW,sdkType:"UNKNOW"}}}}}}}}}function et(){return Ze().platType}function nt(){return Ze().ctx}function rt(){if("boolean"==typeof Ye)return Ye;var e=!1;try{var t=navigator?navigator.userAgent||navigator.swuserAgent:"";if(e=!!/AliApp/i.test(t),/AliApp\((AP|DingTalk|AMAP|UC|QUARK)/i.test(t)&&(e=!1),/AliApp\(KB/i.test(t)&&(e=!!/Mist/.test(t)),/AlipayIDE Taobao/.test(t)&&(e=!0),e){var n=et().ctx;D(n.canIUse)&&(e=!!n.canIUse("callUserTrack"))}}catch(r){}return Ye=e,e}var at={getPlatformType:et,getPlatformSdkType:function(){return Ze().sdkType},getPlatformContext:nt,getLogDomain:function(){return Ze().logDomain},getCurrentPage:function(){var e=getCurrentPages();return e[e.length-1]||{}},getReferrerPage:function(){var e=getCurrentPages();return e[e.length-2]||{}},resetIsTB:function(e){Ye=e},initIsTB:rt,isTB:function(){return"boolean"==typeof Ye?!!Ye:rt()},getWxTitle:function(e){if(!e)return"";var t=et(),n="";try{if(t===Xe.WECHAT&&__wxConfig){var r=__wxConfig,a=__wxConfig.page||{},o=a[e]||a[e+".html"],i={},s={};if(r.global&&r.global.window&&r.global.window.navigationBarTitleText&&(i.title=r.global.window.navigationBarTitleText),o&&o.window&&o.window.navigationBarTitleText&&(s.title=o.window.navigationBarTitleText),!s.title&&__wxAppCode__){var c=__wxAppCode__[e+".json"];c&&c.navigationBarTitleText&&(s.title=c.navigationBarTitleText)}var u=$().ctx;u[q()].globalTitleMap&&b.eachMap(u[q()].globalTitleMap,(function(t,r){t===e&&(n=r)})),0===n.length&&(n=s.title||i.title||"")}return n}catch(p){return B().w("current platform can not track page title"),n}},setStorageSync:function(e,t){try{var n=et(),r=nt();n===Xe.ALIPAY||n===Xe.TAOBAO?r.setStorageSync({key:e,data:t}):r.setStorageSync(e,t)}catch(a){}},getStorageSync:function(e){try{var t=et(),n=nt();return t===Xe.ALIPAY||t===Xe.TAOBAO?n.getStorageSync({key:e}).data:n.getStorageSync(e)}catch(r){}},removeStorageSync:function(e){try{var t=et(),n=nt();t===Xe.ALIPAY||t===Xe.TAOBAO?n.removeStorageSync({key:e}):t===Xe.XHS?n.removeStorage({key:e}):n.removeStorageSync(e)}catch(r){B().e("removeStorageSync failed, errormsg = ",r)}},request:function(e,t,n,r){var a=H(q()),o=nt();D(r)||(r=Je),D(n)||(n=Je);var i=t.requestMethodName||ze,s=o[i];D(s)||i===ze||(s=o[i=ze]),D(s)||i===We||(s=o[i=We]);var c,u,p=t&&t.dataType?t.dataType:"base64",l=a.getMetaInfo(Ie.APLUS_MINI_REQUEST_TIMEOUT),f=t&&t.timeout?t.timeout:l,g=t.method||Oe.GET;if(e=Fe.fixDomain(e),D(s)){var _={url:e,method:g,dataType:p,timeout:f,success:function(e){c||(c=!0,n(e))},fail:function(e){c||(c=!0,r({failure:!0,data:e}))}};g===Oe.POST&&"object"===v(t.data)&&(_.url=_.url.split("?")[0],We===i?(_.headers={"Content-Type":"application/json"},_.dataType="json",_.data=JSON.stringify(t.data)):_.data=t.data),s(_)}else c||(c=!0,r({failure:!0,data:u}));setTimeout((function(){c||(c=!0,u='aplus log request"'+e+' timeout", time spend'+f+"ms",console&&console.warn(u),r({failure:!0,data:u}))}),f)},requestPromise:function(e,t){var n=nt(),r=et();if([Xe.WECHAT,Xe.TIKTOK,Xe.XHS].includes(r))return new Promise((function(a,o){var i=n[ze];i&&D(i)?i(g(g({url:e},t),{},{success:a,fail:o})):B.w("current platform not support request method, platform = ",r)}));B.w("current platform not support Promise, platform = ",r)},getUtmParamsObj:function(e,n){var r={};try{if(!e)return r;b.eachMap(e,(function(a,o){if(0===a.indexOf("utm_"))r[a]="".concat(o);else if("scene"===a&&U.isString(o)){var i=decodeURIComponent(o)||"",s=U.query2obj(i);b.eachMap(s,(function(e,t){0!==e.indexOf("utm_")&&"$sid"!==e||(r[e]="".concat(t))}))}else if("$sid"===a){r[Ie.REF_SHARE_ID]=o,e.$sid;var c=function(e,t){if(null==e)return{};var n,r,a=function(e,t){if(null==e)return{};var n={};for(var r in e)if({}.hasOwnProperty.call(e,r)){if(t.includes(r))continue;n[r]=e[r]}return n}(e,t);if(Object.getOwnPropertySymbols){var o=Object.getOwnPropertySymbols(e);for(r=0;r<o.length;r++)n=o[r],t.includes(n)||{}.propertyIsEnumerable.call(e,n)&&(a[n]=e[n])}return a}(e,Qe),u=j.obj2queryStr(c);r[Ie.REF_SHARE_URL]="".concat(n,"?").concat(u)}else if("q"===a)try{var p=decodeURIComponent(o)||"";if(p.indexOf("?")>-1){var l=p.match(/\$sid=([^&]+)/);l&&l[1]?(r[Ie.REF_SHARE_ID]=l[1],r[Ie.REF_SHARE_URL]=p):B().i("qrcode don't contains $sid info, q = ",o);var f=p.split("?")[1]||"";f&&f.split("&").forEach((function(e){var n=function(e,n){return function(e){if(Array.isArray(e))return e}(e)||function(e,t){var n=null==e?null:"undefined"!=typeof Symbol&&e[Symbol.iterator]||e["@@iterator"];if(null!=n){var r,a,o,i,s=[],c=!0,u=!1;try{if(o=(n=n.call(e)).next,0===t){if(Object(n)!==n)return;c=!1}else for(;!(c=(r=o.call(n)).done)&&(s.push(r.value),s.length!==t);c=!0);}catch(p){u=!0,a=p}finally{try{if(!c&&null!=n.return&&(i=n.return(),Object(i)!==i))return}finally{if(u)throw a}}return s}}(e,n)||function(e,n){if(e){if("string"==typeof e)return t(e,n);var r={}.toString.call(e).slice(8,-1);return"Object"===r&&e.constructor&&(r=e.constructor.name),"Map"===r||"Set"===r?Array.from(e):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?t(e,n):void 0}}(e,n)||function(){throw new TypeError("Invalid attempt to destructure non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(e.split("="),2),a=n[0],o=n[1];0===a.indexOf("utm_")&&(r[decodeURIComponent(a)]=decodeURIComponent(o))}))}}catch(g){B().w("handle query error:",g)}}))}catch(a){B().e("handle query error:",a)}return r},PLATFORM_TYPE:Xe};function ot(e){if(e.__esModule)return e;var t=e.default;if("function"==typeof t){var n=function e(){if(this instanceof e){var n=[null];return n.push.apply(n,arguments),new(Function.bind.apply(t,n))}return t.apply(this,arguments)};n.prototype=t.prototype}else n={};return Object.defineProperty(n,"__esModule",{value:!0}),Object.keys(e).forEach((function(t){var r=Object.getOwnPropertyDescriptor(e,t);Object.defineProperty(n,t,r.get?r:{enumerable:!0,get:function(){return e[t]}})})),n}var it="2.3.4";function st(e,t){try{!function(){if(e&&E.isArray(e)&&e.length){for(var n=ht(e).queue,r={},a=[];r=n.shift();)_t(r,t,(function(e){a.push(e)}));a.length>0&&setTimeout((function(){for(;r=a.shift();)_t(r,t)}),100)}}()}catch(n){B().w(n)}}function ct(){return(Q("_$")||{}).meta_info}var ut=[],pt=[],lt=[];function ft(e){st(ut,e),st(pt,e),st(lt,e)}function gt(e,t){return t&&me.indexOf(e)>-1&&(e="_".concat(e)),e}function _t(e,t,n){var r=!!t.isOpenApi,a=e?e.action:"",o=e?e.arguments:"",i=function(e){var t,n=(t=ct()||{},"1"!=="".concat(t.uaid)||t._anony_id?t._hold||t["aplus-waiting"]:"BLOCK"),r=ct()||{},a=!0,o=e.arguments||[],i=o[0],s=o[1],c="START";return"_hold"===i&&s===c||"_anony_id"===i&&s?c:(e&&/sendPV|record|setPageSPM|setMetaInfo|appendMetaInfo$/.test(e.action)&&"BLOCK"===n&&!r[n]&&(lt.push(e),a=!1),a)}(e);if(i){var s=$().ctx;try{if(a&&o&&E.isArray(o)){var c,u=a.split("."),p=s,l=s;if(3===u.length)l=(p=s[u[0]][u[1]]||{})[c=gt(u[2],r)]?p[c]:"";else for(;u.length;)if(l=p=p[c=gt(u.shift(),r)],!p)return void(D(n)&&n(e));D(l)&&l.apply(p,o),"START"===i&&ft(t)}}catch(f){B().w(f)}}}function ht(e,t){for(var n,r={subscribeMwChangeQueue:[],subscribeMetaQueue:[],subscribeQueue:[],metaQueue:[],othersQueue:[]},a={};a=e.shift();)try{var o=a.action,i=a.arguments[0];/subscribe/.test(o)?"setMetaInfo"===i?r.subscribeMetaQueue.push(a):i===de.MW_CHANGE_PV||i===de.MW_CHANGE_HJLJ?r.subscribeMwChangeQueue.push(a):r.subscribeQueue.push(a):/MetaInfo/.test(o)?r.metaQueue.push(a):r.othersQueue.push(a)}catch(s){B().w(s),r.othersQueue.push(a)}return t&&r[t]&&(n=r[t],r[t]=[]),{queue:r.subscribeMwChangeQueue.concat(r.metaQueue).concat(r.subscribeQueue).concat(r.subscribeMetaQueue,r.othersQueue),formatQueue:n}}var dt,mt,vt,yt=F.extend({push:function(e){this.length++,_t(e,this.opts)}}),St=s((function e(t){o(this,e),this.options=t}),[{key:"processAplusQueue",value:function(e){var t=this.options.config||{},n=H(e);st(n,t),Y(e,yt.create({opts:t,startLength:n.length,length:0}))}},{key:"run",value:function(){var e,t,n=this.options.context.sdk_config.queueName;this.processAplusQueue(n),e=n,t=this.options.config,H(e).push({action:de.SUBSCRIBE,arguments:[de.SET_META_INFO,function(e,n){e===Ie.DEBUG?B().setDebug(!!n):e===de._USER_ID&&n?st(ut,t):e===de._ANONY_ID&&n?st(pt,t):"_hold"===e&&"START"===n&&ft(t)}]})}}]),Et=ot(Object.freeze({__proto__:null,default:St})),At=function(){var e=null,t="",n=null,r=!1;function a(){var e=at.getPlatformContext();this.load=function(a){n?(e.removeStorage({key:t}),D(a)&&a()):(t="aplus_cache_".concat(Fe.getAppKey()),e.getStorage({key:t,success:function(o){n=o&&o.data&&w(o.data)||{},r=!0,e.removeStorage({key:t}),D(a)&&a()},fail:function(o){B().w("".concat(t,": ").concat(o.errMsg)),n={},r=!0,e.removeStorage({key:t}),D(a)&&a()}}))},this.save=function(){n&&e.setStorage({key:t,data:O(n)})},this.set=function(e,t){n&&(n[e]=t)},this.get=function(e){return(n||{})[e]},this.remove=function(e){n&&n[e]&&delete n[e]},this.getAll=function(){return n},this.clear=function(){n=null},this.has=function(e){return!!this.get(e)},this.isLoaded=function(){return r},this.getSync=function(e){try{var t=at.getStorageSync(e);return e===Ie.APLUS_IMPRINT_VERSION?t:"string"==typeof t?w(t):t}catch(n){}},this.setSync=function(e,t){try{"object"===v(t)?at.setStorageSync(e,JSON.stringify(t)):at.setStorageSync(e,t)}catch(n){}}}return function(){return e||(e=new a),e}}(),It=(dt=null,mt=null,vt=null,function(){return dt||(dt={resume:function(e){var t=!1;return vt||(vt=At().get(Ie.CURRENT_SESSION)),mt=Date.now(),(!vt||!vt.end_time||mt-vt.end_time>Ie.SESSION_INTERVAL)&&(t=!0,function(e){try{var t=(vt||{}).options||{},n=A({},function(e){var t={};for(var n in e)t[n]=e[n];return t}(e.query));n.path=e.path||t.path,n.scene=e.scene?"".concat(at.getPlatformType(),"_").concat(e.scene):t.scene;var r=e.referrerInfo;r&&(n.referrerAppId=r.appId);var a=H(q()).getMetaInfo(Ie.GLOBAL_PROPERTY),o=Date.now();vt={id:U.getRandomStr(10)+o,start_time:o,options:n,state_s:1},a&&(vt.gp=a)}catch(i){B().e("generate new session failed, errmsg: ",i)}}(e)),t},pause:function(){!function(){if(vt){var e=new Date;vt.end_time=Date.now(),"number"!=typeof vt.duration&&(vt.duration=0),vt.duration=vt.end_time-mt,vt.state_s=0,At().set(Ie.CURRENT_SESSION,vt),B().i("session end (%s): %s ",vt.id,e.toLocaleTimeString(),vt)}}()},getCurrentSessionId:function(){return(vt||{}).id},getCurrentSession:function(){return vt},cloneCurrentSession:function(){return I(vt)}}),dt}),Pt=function(){var e,t,n,r=[],a=[];function o(e,n){var r=(e=e||{})[t];return S(r)&&r.length?e[t]=r.concat(n):e[t]=[].concat(n),e}return function(){return e||(e={addEvent:function(e){e&&(t=t||"sessionid")&&(r.unshift(e),r.length>Ie.MEMORY_MAX_COUNT&&(!function(){if(r.length){var e=At().get(Ie.EKVS);(function(e){var t=0;for(var n in e)S(e[n])&&(t+=e[n].length);return t})(e)+r.length<=Ie.EVENT_MAX_COUNT&&(e=o(e,r),At().set(Ie.EKVS,e))}}(),r.length=0))},setSessionId:function(e){if(t=e,S(a)&&a.length&&t){for(var n=0;n<a.length;n++)this.addEvent(a[n]);a.length=0}},setStartId:function(e){n=e},getStartId:function(){return n},getEkvs:function(){var e=At().get(Ie.EKVS);return r&&r.length&&(e=o(e,r)),e},getEkvsLen:function(){var e=(At().get(Ie.EKVS)||{})[t]||[],n=r?r.length:0;return e.length+n},clear:function(){At().remove(Ie.EKVS),r.length=0,a.length=0}}),e}}();function bt(e){var t;return t=function(){try{return window}catch(e){}}()?Fe.RemoteCfgUtils.get(Ie.APLUS_REMOTE_CONFIG):At().getSync(Ie.APLUS_REMOTE_CONFIG),!!b.isEmptyObject(t)||t&&t[e]}function Tt(){return H(q()).getMetaInfo(Ie.APLUS_DISABLE_AUTOEVENT_REMOTE)||bt(we.codelessClickEventStatus)}function Ot(){return bt(we.currentDeviceEnable)}function wt(){var e=H(q()).getMetaInfo(Ie.APLUS_DISABLE_AUTOPV_REMOTE)||bt(we.codelessCollectorPageStatus);return"number"==typeof e?e:0}function Ct(){return H(q()).getMetaInfo(Ie.APLUS_AUTOTRACK_ENABLED_REMOTE)||bt(we.codelessStatus)}function Dt(e){var t,n,r,a=H(G());e&&!b.isEmptyObject(e)&&(n=e.codelessClickEventStatus,H(G()).push({action:Pe.setMetaInfo,arguments:[Ie.APLUS_DISABLE_AUTOEVENT_REMOTE,n]}),r=e.codelessCollectorPageStatus,H(G()).push({action:Pe.setMetaInfo,arguments:[Ie.APLUS_DISABLE_AUTOPV_REMOTE,r]}),function(e){H(G()).push({action:Pe.setMetaInfo,arguments:[Ie.APLUS_AUTOTRACK_ENABLED_REMOTE,e]})}(e.codelessStatus),t=e.currentDeviceEnable,H(G()).push({action:Pe.setMetaInfo,arguments:[Ie.APLUS_DEVICE_ENABLE,t]}),e.eventSamplingRate&&e.eventSamplingRate.length>0&&a.push({action:Pe.setMetaInfo,arguments:[Ie.APLUS_EVENT_LIMITRATES,Fe.mapEventSampleRates(e.eventSamplingRate)]}),e.codelessIgnoreComponent&&e.codelessIgnoreComponent.length>0&&a.push({action:Pe.setMetaInfo,arguments:[Ie.APLUS_AUTOTRACK_CONFIG_REMOTE,e.codelessIgnoreComponent]}))}var kt={getAutoEventStatus:Tt,enableCfg:Dt,getAutoTrackStatus:Ct,getAutoPageStatus:wt,getDeviceStatus:Ot},Rt=function(){return s((function e(){return o(this,e),e.instance||((e.instance=this).capacity=1,e.instance.tokens=1,e.instance.fillRate=1,e.instance.lastFillTime=Date.now(),e.instance.loaded=!1),e.instance}),[{key:"run",value:function(){var e=this;setInterval((function(){e.fill()}),1e3)}},{key:"load",value:function(){if(!this.loaded){var e=H(q()).getMetaInfo(Ie.APLUS_MINI_REQUESTS_LIMIT);this.capacity="number"==typeof e&&e<=5&&e>=1?e:1,this.loaded=!0}}},{key:"fill",value:function(){var e=Date.now(),t=(e-this.lastFillTime)*(this.fillRate/1e3);this.tokens=Math.ceil(Math.min(this.tokens+t,this.capacity)),this.lastFillTime=e}},{key:"consume",value:(e=r(h().mark((function e(t){var n;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!(t<=this.tokens)){e.next=5;break}return this.tokens-=t,e.abrupt("return",{allowed:!0});case 5:return n=1e3*Math.ceil((t-this.tokens)/this.fillRate),e.abrupt("return",{allowed:!1,waitTime:n});case 7:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})}]);var e}(),Mt=new Rt;function Nt(e){var t=e,n=[];this.enqueue=function(e){"number"==typeof t&&this.size()>=t&&this.dequeue(),n.push(e)},this.dequeue=function(){return n.shift()},this.front=function(){return n[0]},this.isEmpty=function(){return 0===n.length},this.clear=function(){n.length=0},this.size=function(){return n.length},this.items=function(){return n},this.print=function(){B().i("---queue: ",n.toString())}}function xt(e){var t={},n=e.networkType;switch("none"===n&&(n="unknown"),n=n?n.toLowerCase():""){case Fe.AccessType.MOBILE_NETWORK_4G:t.access_subtype="LTE",t.access="4G";break;case Fe.AccessType.MOBILE_NETWORK_3G:t.access_subtype="CDMA",t.access="3G";break;case Fe.AccessType.MOBILE_NETWORK_2G:t.access_subtype="GRPS",t.access="2G";break;default:t.access=n,delete t.access_subtype}return t}var Lt="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/",Ut=function(e){for(var t={},n=0,r=e.length;n<r;n++)t[e.charAt(n)]=n;return t}(Lt),jt=String.fromCharCode,Bt=function(e){var t;return e.length<2?(t=e.charCodeAt(0))<128?e:t<2048?jt(192|t>>>6)+jt(128|63&t):jt(224|t>>>12&15)+jt(128|t>>>6&63)+jt(128|63&t):(t=65536+1024*(e.charCodeAt(0)-55296)+(e.charCodeAt(1)-56320),jt(240|t>>>18&7)+jt(128|t>>>12&63)+jt(128|t>>>6&63)+jt(128|63&t))},Ft=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,Kt=function(e){var t=[0,2,1][e.length%3],n=e.charCodeAt(0)<<16|(e.length>1?e.charCodeAt(1):0)<<8|(e.length>2?e.charCodeAt(2):0);return[Lt.charAt(n>>>18),Lt.charAt(n>>>12&63),t>=2?"=":Lt.charAt(n>>>6&63),t>=1?"=":Lt.charAt(63&n)].join("")},Vt=function(e){return e.replace(Ft,Bt).replace(/[\s\S]{1,3}/g,Kt)};function $t(e,t){return t?Vt(String(e)).replace(/[+\/]/g,(function(e){return"+"===e?"-":"_"})).replace(/\=/g,""):Vt(String(e))}var qt=new RegExp(["[À-ß][-¿]","[à-ï][-¿]{2}","[ð-÷][-¿]{3}"].join("|"),"g"),Gt=function(e){switch(e.length){case 4:var t=((7&e.charCodeAt(0))<<18|(63&e.charCodeAt(1))<<12|(63&e.charCodeAt(2))<<6|63&e.charCodeAt(3))-65536;return jt(55296+(t>>>10))+jt(56320+(1023&t));case 3:return jt((15&e.charCodeAt(0))<<12|(63&e.charCodeAt(1))<<6|63&e.charCodeAt(2));default:return jt((31&e.charCodeAt(0))<<6|63&e.charCodeAt(1))}},Ht=function(e){var t=e.length,n=t%4,r=(t>0?Ut[e.charAt(0)]<<18:0)|(t>1?Ut[e.charAt(1)]<<12:0)|(t>2?Ut[e.charAt(2)]<<6:0)|(t>3?Ut[e.charAt(3)]:0),a=[jt(r>>>16),jt(r>>>8&255),jt(255&r)];return a.length-=[0,0,2,1][n],a.join("")},Yt=[];function Qt(e,t){var n=Wt(e,t);return e&&e.id_tracking&&(n[t.id_tracking||"id_tracking"]=Wt(e.id_tracking,Ae)),n}function Wt(e,t){var n={};for(var r in e)t[r]?n[t[r]]=e[r]:n[r]=e[r];return n}function zt(e,t){var n={};if(e)for(var r in e)e[r]&&(n[t[r]]=e[r]);return n}var Jt=s((function e(){o(this,e),this._imprint=""}),[{key:"set",value:function(e){this._imprint="string"==typeof e?e:$t(JSON.stringify(e))}},{key:"get",value:function(){return this._imprint}},{key:"getImpObj",value:function(){return w((e=this._imprint,function(e){return e.replace(/[\s\S]{1,4}/g,Ht).replace(qt,Gt)}(String(e).replace(/[-_]/g,(function(e){return"-"===e?"+":"/"})).replace(/[^A-Za-z0-9\+\/]/g,""))));var e}},{key:"getItem",value:function(e){var t=this.getImpObj();return t&&t[e]||""}},{key:"load",value:function(){this._imprint=At().get(Ie.IMPRINT)}},{key:"save",value:function(){this._imprint&&At().set(Ie.IMPRINT,this._imprint)}}]),Xt=new Jt;function Zt(e,t,n,r){var a,o=H(q()),i=function(){var e={},t=H(q()),n=t.globalConfig||{},r=t._aplus_client||{},a=At().get(Ie.IMPRINT);a&&(e.imprint=a),e.device_type="Phone",e.sdk_version=n.lver,e.appkey=Fe.getAppKey(),e.device_info="",e.appid=r.appId,e.app_version=t.getMetaInfo("appVersion")||"devtools";var o=t.getMetaInfo("aplus-global-args");o&&o.debugId?e.miniappDebugId=o.debugId:At().get("miniappDebugId")&&(e.miniappDebugId=At().get("miniappDebugId"));var i=r||{};i.safeArea=i.safeArea||{};var s=i.model||"",c=i.platform||"",u=i.brand||"",p=u.toLowerCase();e.sdk_type=at.getPlatformSdkType(),e.platform=at.getPlatformType(),e.platform_sdk_version=i.SDKVersion,e.platform_version=i.platformVersion;var l=Math.round(i.screenWidth*i.pixelRatio),f=Math.round(i.screenHeight*i.pixelRatio);e.resolution=l>f?"".concat(l,"*").concat(f):"".concat(f,"*").concat(l),e.pixel_ratio=i.pixelRatio,e.os=c,e.font_size_setting=i.fontSizeSetting,e.device_model=s,e.device_brand=u,e.device_manufacturer=p,e.device_manuid=s,e.device_name=s,e.os_version=i.os_version,e.language=i.language;var g=xt(r);return e.access=g.access,g.access_subtype&&(e.access_subtype=g.access_subtype),e}();try{if(at.getPlatformType()===at.PLATFORM_TYPE.ALIPAY||at.getPlatformType()===at.PLATFORM_TYPE.TAOBAO?(i.id_type="alipay_id",i.id_tracking={alipay_id:o.getMetaInfo(de._ANONY_ID)||At().get(de._ANONY_ID)||"",unionid:o.getMetaInfo(de._DEV_ID)||At().get(de._DEV_ID)||"",userId:o.getMetaInfo(de._USER_ID)||""}):(i.id_type="openid",i.id_tracking={openid:o.getMetaInfo(de._ANONY_ID)||At().get(de._ANONY_ID)||"",unionid:o.getMetaInfo(de._DEV_ID)||At().get(de._DEV_ID)||"",userId:o.getMetaInfo(de._USER_ID)||""}),Xt.get()&&(i[Ie.IMPRINT]=Xt.get()),e.analytics){var s=o.getMetaInfo(de._USER_ID)||at.getStorageSync(de._USER_ID),c=o.getMetaInfo("_user_nick");e.analytics.active_user={puid:s,provider:c}}var u=Date.now();e.header=b.assign(i,g(g({},e.header),{},{traceId:U.getRandomStr(10)+u+U.getRandomStr(9),start_id:Pt().getStartId()}));var p={h:Qt((a=e).header,Ee),a:zt(a.analytics,ye)},l=O(p),f=function(){var e=H(q()),t=e.getMetaInfo(Ie.TRACKDOMAIN)||e.getMetaInfo(Ie.APLUS_PV_DOMAIN);if(!Fe.checkDomain(t))return"";var n=at.getLogDomain();return n?Fe.fixDomain(t)+n:(B().tip_w("current miniapp framework is not supported!!"),"")}(),_=o.getMetaInfo(Ie.APLUS_MINI_REQUEST_TIMEOUT),h={url:f,method:Oe.POST,data:$t(l),timeout:_,success:function(r){var o,i,s=r.code||r.status||r.statusCode;if(s===Te.OK||s===Te.PAYLOAD_TOO_LARGE){B().i("event send success:",e,l);try{r.profile&&("number"==typeof(i=(o={end:r.profile.responseEnd,start:r.profile.requestStart}).end-o.start)&&i>=300?Yt.push(i):Yt=[],Yt.length>=10&&(H(q())._record(Ie.PERFORMANCE_WARING,"OTHER",{}),Yt=[]))}catch(a){B().w("current miniapp not support profile API")}!function(e){var t=At().getSync(Ie.APLUS_IMPRINT_VERSION);if(e){var n=H(q());if(e.imprintVersion&&e.imprintVersion!==t){var r=e.imprintVersion;At().setSync(Ie.APLUS_IMPRINT_VERSION,r);var a=n.getMetaInfo(Ie.APLUS_PV_DOMAIN)||n.getMetaInfo(Ie.TRACKDOMAIN),o=Fe.fixDomain(a)+r;n.requestRemoteConfig(o,(function(e){e.data&&e.data.data&&(Dt(e.data.data),At().setSync(Ie.APLUS_REMOTE_CONFIG,e.data.data))}),(function(e){B().w("remote configuration request failed, errmsg:",e)}))}else Dt(At().getSync(Ie.APLUS_REMOTE_CONFIG))}}(r.data||{}),D(t)&&t(r)}else B().w("event send failed:",l),D(n)&&n()},fail:function(e){Date.now()-u<d?(B().w("event send failed:",l),B().w("event send failed because ",e)):(B().w("current request timeout:",d),B().w("event send timeout:",l)),D(n)&&n()},complete:function(){D(r)&&r()}},d=o.getMetaInfo(Ie.APLUS_MINI_REQUEST_TIMEOUT);d&&(h.timeout=d),function(e){var t=at.getPlatformContext();try{t.request(e)}catch(n){try{dd&&dd.httpRequest(e)}catch(r){B().w("request send failed, err msg: ",r)}}}(b.assign(h,"dd"===at.getPlatformType()?{headers:{"Content-Type":"application/json"}}:{header:{"content-type":"application/json"}}))}catch(a){}}var en=function(e){return new Promise((function(t){return setTimeout(t,e)}))},tn=function(e){if(e&&e.analytics&&e.analytics.ekvs)return Object.keys(e.analytics.ekvs)[0]},nn=function(e){var t=[];if(E.isArray(e)&&e.length>0){Array.from(new Set(e.map((function(e){return e.header.start_id})))).forEach((function(n){var r,a=e.filter((function(e){return e.header.start_id===n})).reduce((function(e,t,n,a){if(e){r=b.cloneDeep(e);var o=tn(e);return r.analytics.ekvs[o]=r.analytics.ekvs[o].concat(t.analytics.ekvs[o]),r}return a[n]}));t.push(a)}));for(var n=new Array(t.length).fill([]),r=Object.create(null),a=0;a<t.length;a++){for(var o=t[a],i=tn(o),s=o.analytics.ekvs[i].filter((function(e){return!!e})).map((function(e){return e.uuid})),c=0;c<s.length;c++){var u=s[c];r[u]?n[a].push(c):r[u]=1}n[a].length>0&&o.analytics.ekvs[i].splice(n[a][0],n[a].length)}}return t},rn=function(){return s((function e(){o(this,e),this.queue=new Nt,this.isProcessing=!1,this.Tag=""}),[{key:"enqueue",value:function(e,t,n){t=t||{};var r=function(e){var t,n,r=null;switch(e){case"half_session":t=null,(n=It().cloneCurrentSession())&&(t={header:{st:"1"},analytics:{sessions:[n]}}),r=t;break;case"close_session":r=function(){var e=null,t={},n=It().cloneCurrentSession();n&&(t.sessions=[n]);var r=Pt().getEkvs();return r&&(t.ekvs=I(r),Pt().clear()),(t.sessions||t.ekvs)&&(e={analytics:t}),e}();break;case be:r=function(){var e=null,t=Pt().getEkvs();return t&&(e={analytics:{ekvs:I(t)}},Pt().clear()),e}()}return r}(e);if(r){var a=H(q())._aplus_client||{};r.header=A(r.header,xt(a)),r.noCache=t.noCache,this.queue.enqueue(r)}this.isProcessing||this.processQueue(n)}},{key:"load",value:function(e){var t=this,n=At().get(e);n&&n.length&&n.forEach((function(e){t.queue.enqueue(e)})),At().remove(e)}},{key:"processQueue",value:(e=r(h().mark((function e(t){var n,r,a,o;return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:this.isProcessing=!0;case 1:if(!(this.queue.size()>0)){e.next=17;break}return n=this.queue.front(),e.next=5,Mt.consume(1);case 5:if(r=e.sent,a=r.allowed,o=r.waitTime,!a){e.next=13;break}this.queue.dequeue(),cn(n),e.next=15;break;case 13:return e.next=15,en(o);case 15:e.next=1;break;case 17:this.isProcessing=!1,D(t)&&t();case 19:case"end":return e.stop()}}),e,this)}))),function(t){return e.apply(this,arguments)})}]);var e}(),an=function(e){function t(){var e;return o(this,t),e=a(this,t),t.instance||(t.instance=e),_(e,t.instance)}return p(t,rn),s(t,[{key:"prepare",value:function(e,t,n){var r=H(q());Fe.checkOpenid(r.getMetaInfo(de._ANONY_ID)),e===be?this.enqueue(e,t,(function(){D(n)&&n()})):this.isProcessing||this.processQueue(n)}}])}(),on=new(function(e){function t(){var e;return o(this,t),e=a(this,t),t.instance||(t.instance=e,t.instance.failedRequests=[]),_(e,t.instance)}return p(t,rn),s(t,[{key:"prepare",value:function(){var e=this;nn(this.failedRequests).forEach((function(t){e.queue.enqueue(t)}))}},{key:"clearFailedRequests",value:function(){this.failedRequests.length=0}},{key:"save",value:function(){var e=(At().get(Ie.FAILED_REQUESTS)||[]).concat(this.failedRequests),t=nn(e);t&&t.length&&At().set(Ie.FAILED_REQUESTS,t),this.clearFailedRequests()}}])}()),sn=new an,cn=function(){var e=r(h().mark((function e(t){return h().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:t&&Zt(t,(function(){}),(function(){t&&!t.noCache&&on.failedRequests.push(t)}));case 1:case"end":return e.stop()}}),e)})));return function(t){return e.apply(this,arguments)}}(),un=0;function pn(e,t){var n={};return t&&(n.scene=t),e&&e.miniappDebugId&&(n.debugId=e.miniappDebugId),n}var ln=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){["object","function"].indexOf("undefined"==typeof App?"undefined":v(App))>-1&&function(){var e=App,t=!1,n=!1,r=$().ctx,a=G(),o=at.getPlatformContext(),i=function(e){at.initIsTB(),B().i("app onLaunch options: \n",e);var t=e?e.query:{},n=e?e.referrerInfo:{};if(kt.enableCfg(At().getSync(Ie.APLUS_REMOTE_CONFIG)),un+=1,r[a].push({action:Pe.appendMetaInfo,arguments:["aplus-session-args",b.assign(n,{scene:e.scene||""})]}),t){var o={};if(t.spm&&(r.aplus.spm_orign=t.spm),e.scene&&(o.scene=e.scene),t.miniappDebugId){var i=t.miniappDebugId.trim(),s=i.split("_");o=b.assign(o,{aplus_work_no:s.length>2?s[1]:i,aplus_track_debug_id:i,aplus_flag:"aplus_test"})}r[a].push({action:Pe.appendMetaInfo,arguments:["aplus-exdata",o]}),r[a].push({action:Pe.appendMetaInfo,arguments:["aplus-cpvdata",o]}),r[a].push({action:Pe.appendMetaInfo,arguments:["aplus-global-args",pn(t,e.scene)]})}},s=function(e){B().i("app onShow options: \n",e),un+=1;var n,o=e?e.query:{},i=e?e.scene:"";r[a].push({action:de.SDK_APPEND_META_INFO,arguments:["aplus-global-args",pn(o,i)]}),r[a].push({action:Pe.appendMetaInfo,arguments:[Ie.GLOBAL_PROPERTY,at.getUtmParamsObj(o,e.path)]}),i&&(r[a].push({action:Pe.appendMetaInfo,arguments:["aplus-exdata",{scene:i}]}),r[a].push({action:Pe.appendMetaInfo,arguments:["aplus-cpvdata",{scene:i}]}),r[a].push({action:Pe.appendMetaInfo,arguments:["aplus-session-args",{scene:i}]})),2===un?n=1:1===un?n=0:B().w("APP_LAUNCH_TYPE should not reach this, value = ".concat(un)),Mt.load(),Mt.run(),t||(t=!0,function(e){At().load((function(){B().w("cache init success"),e.query&&e.query.miniappDebugId&&e.query.miniappDebugId!==At().get("miniappDebugId")&&At().set("miniappDebugId",e.query.miniappDebugId)}));var t={},n=b.cloneDeep(e);for(var r in n)"object"===v(n[r])?t=b.assign(n[r],t):n[r]&&(t[r]=n[r]);var a=It().resume(t),o=It().getCurrentSessionId();Pt().setSessionId(o),a&&(on.load(Ie.FAILED_REQUESTS),on.processQueue())}(e)),Fe.RankUtils.clear();var s=Fe.getStartId();Pt().setStartId(s),r.onAppShowTime=Date.now(),r[G()].push({action:Pe.record,arguments:[Ie.APP_START,"SHOW",{start_type:n,is_auto:1,currentPath:e.path||""}]})},c=function(){var e=Date.now()-r.onAppShowTime;r[G()].push({action:Pe.record,arguments:[Ie.APP_END,"H_OR_U",{duration:e,end_type:0,start_time:r.onAppShowTime,is_auto:1}]}),t=!1,It().pause(),on.prepare(),on.processQueue().then((function(){on.save(),At().save()})),un=0};if(e.after)e.after({methods:{onLaunch:function(e){e.thisObject&&(e.thisObject[q()]=r[q()]),i(e.args)},onShow:function(e){s(e.args)},onHide:function(){c()}}});else{App=function(t){t[q()]=r[q()],e(t)};try{o.onAppShow((function(e){var t;n||(t=D(o.getLaunchOptionsSync)?o.getLaunchOptionsSync()||{}:e,i(t),n=!0),s(e)})),o.onAppHide((function(){c()})),function(e){try{my&&my.onTitleCloseClick&&e&&my.onTitleCloseClick(e)}catch(t){}}(c)}catch(u){B().w("hook app failed, errmsg = ",u)}}}()}}]),fn=ot(Object.freeze({__proto__:null,default:ln})),gn="",_n={};function hn(e){var t=H(q()).getMetaInfo("pageConfig")||{},n=e||gn;try{if(t&&"object"===v(t))for(var r in t){if(r===n)break;if(t[r]&&t[r].regRule&&t[r].regRule.test(n)){n=r;break}}}catch(a){}return t[n]}var dn={getCurrentPagePath:function(){return gn},getPrePagePath:function(e){return e&&-1!==e.indexOf("?")?e.split("?")[0]:e},setCurrentPath:function(e){e&&(gn=e)},getPageQuery:function(e){if(e)return _n[e]},setPageQuery:function(e,t){e&&(_n[e]=t)},getFullPath:function(e){return function(e,t){if(!e||"-"===e)return"";var n=[];for(var r in t)n.push("".concat(r,"=").concat(t[r]));var a=n.join("&");return a?"".concat(e,"?").concat(a):e}(e,_n[e])},getPageOptions:hn,getPageName:function(e){return(hn(e)||{}).pageName},getPrePageName:function(e){return(hn(e)||{}).pageName},getPageTitle:function(e){return(hn(e)||{}).pageTitle||at.getWxTitle(e)},getVTRealtimeCode:function(){if(gn){var e=_n[gn]||{},t=/^\$vt_/,n=decodeURIComponent(e.scene);return n&&t.test(n)&&n.replace(t,"")}},getPageProperties:function(e){return(hn(e)||{}).properties},skipPage:function(e){return(hn(e)||{}).skipMe}},mn={onAplusReady:function(e,t,n){e.push({action:t,arguments:[de.SDK_READY,function(e){"complete"===e&&"function"==typeof n&&n()}]})},getIndexByRect:function(e,t,n){var r=-1;at.getPlatformContext().createSelectorQuery().selectAll(e).boundingClientRect(t).exec((function(e){E.each(e[0],(function(e,n){e.width<=t.width&&e.height===t.height&&e.left===t.left&&e.top===t.top&&e.right===t.right&&(e.bottom,t.bottom),r=n})),n(r)}))}};function vn(e,t){var n=at.getCurrentPage(),r=n.route||n.is||"",a=n.options||{},o=$().ctx,i=G(),s=j.obj2queryStr(a,!0),c=b.cloneDeep(e);s&&(r="".concat(r,"?").concat(s)),b.isEmptyObject(c.query)?c.query=a:"string"==typeof c.query&&(c.query=U.query2obj(c.query));var u=c.path||r;return c.path=u,c.status="ready",e.promise&&(c.promise=e.promise),o[i].push({action:de.PUBLISH,arguments:[t,c]}),c}function yn(){$().ctx[G()].push({action:de.PUBLISH,arguments:["onPullDownRefresh",{status:"ready"}]})}function Sn(){var e={status:"ready",context:this};$().ctx[G()].push({action:de.PUBLISH,arguments:["onReachBottom",e]})}function En(e){var t=$().ctx,n=G();try{dn.setCurrentPath(this.route),e&&dn.setPageQuery(this.route,e),B().i("Page onLoad: ",this.route,e);var r=this;mn.onAplusReady(t[n],de.SUBSCRIBE,(function(){var a,o,i,s=(a=at.getUtmParamsObj(e,r.route),o=$().ctx[q()].getMetaInfo(Ie.GLOBAL_PROPERTY),i=Object.keys(a),b.eachMap(o,(function(e){var t=!1;y(i,(function(e){if(U.isStartWith(e,"utm_"))return t=!0,"break"})),t&&0===e.indexOf("utm_")&&!a[e]&&delete o[e]})),Object.assign({},o,a));t[q()].appendMetaInfo(Ie.GLOBAL_PROPERTY,s),t[n].push({action:de.PUBLISH,arguments:["onLoad",{status:"ready",context:r}]});var c=at.getCurrentPage();Fe.resetFn(c,"setData",(function(e){t[n].push({action:de.PUBLISH,arguments:["onPageDataChanged",{data:e,context:r}]})}))}))}catch(a){B().w("onPageLoad: ",a)}}function An(){var e=$().ctx,t=G(),n=this;try{dn.setCurrentPath(this.route);var r=this;setTimeout((function(){mn.onAplusReady(e[t],de.SUBSCRIBE,(function(){e[t].push({action:de.PUBLISH,arguments:["onShow",{status:"ready",context:r,route:n.route}]})}))}),0)}catch(a){B().w("onPageShow: ",a)}}function In(){var e=$().ctx,t=G();try{e[t].push({action:de.PUBLISH,arguments:["onReady",{status:"ready",context:this,route:this.route}]})}catch(n){B().w("onPageReady: ",n)}}function Pn(){var e=$().ctx,t=G();try{e[t].push({action:de.PUBLISH,arguments:["onHide",{status:"ready",route:this.route}]})}catch(n){B().w("onPageHide: ",n)}}function bn(e){$().ctx[G()].push({action:de.PUBLISH,arguments:["onAplusClk",{status:"ready",event:e,context:this}]})}function Tn(e){$().ctx[G()].push({action:de.PUBLISH,arguments:["onAplusTouch",{status:"ready",context:this,event:e}]})}function On(e){if(e.onShareAppMessage){var t=e.onShareAppMessage;e.onShareAppMessage=function(e){var n=t.call(this,e)||{};return n.from=e&&e.from,vn(n,"onShareAppMessage")}}}function wn(){try{var e,t=Page;t.after&&(e=t.after),Page=function(e){Fe.FunctionUtils.rewriteFn(e,"onShow",An),Fe.FunctionUtils.rewriteFn(e,"onHide",Pn),Fe.FunctionUtils.rewriteFn(e,"onUnload",Pn),Fe.FunctionUtils.rewriteFn(e,"onLoad",En),Fe.FunctionUtils.rewriteFn(e,"onReady",In),Fe.FunctionUtils.rewriteFn(e,"onPullDownRefresh",yn),Fe.FunctionUtils.rewriteFn(e,"onReachBottom",Sn),Fe.FunctionUtils.rewriteFn(e,"onAplusClk",bn),Fe.FunctionUtils.rewriteFn(e,"onAplusTouch",Tn),On(e),function(e){if(e.onShareTimeline){var t=e.onShareTimeline;e.onShareTimeline=function(e){return vn(t.call(this,e)||{},"onShareTimeline")}}}(e),function(e){if(e.onAddToFavorites){var t=e.onAddToFavorites;e.onAddToFavorites=function(e){var n=t.call(this,e)||{};$().ctx[G()].push({action:de.PUBLISH,arguments:["onAddToFavorites",n]})}}}(e),t(e)},e&&(Page.after=function(){e.apply(this,arguments)})}catch(n){B().w("Page hook error")}}function Cn(){try{var e=Component;Component=function(t){try{t.methods=t.methods||{};var n=t.methods;Fe.FunctionUtils.rewriteFn(n,"onShow",An),Fe.FunctionUtils.rewriteFn(n,"onHide",Pn),Fe.FunctionUtils.rewriteFn(n,"onUnload",Pn),Fe.FunctionUtils.rewriteFn(n,"onLoad",En),On(n),e(t)}catch(r){e(t)}}}catch(t){B().w("Component hook error")}}function Dn(e,t,n){["object","function"].indexOf(v(e))>-1?n():B().w("typeof ".concat(t," is not object cant watchExp."))}var kn={},Rn=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){Dn(Page,"Page",wn),Dn(Component,"Component",Cn),function(){var e=this,t=$().ctx,n=at.getPlatformContext();try{if(n&&n.setNavigationBarTitle){var r=n.setNavigationBarTitle;Object.defineProperty(n,"setNavigationBarTitle",{get:function(){return function(n){var a=at.getCurrentPage(),o=a.route||a.is;n=b.isObject(n)?n:{},kn[o]=n.title,t[q()].globalTitleMap=kn,r.call(e,n)}}})}}catch(a){B().w(a)}}()}}]),Mn=ot(Object.freeze({__proto__:null,default:Rn})),Nn=function(e){for(var t=e.length,n=new Array(t-1),r=1;r<t;r++)n[r-1]=e[r];return n},xn=F.extend({callable:function(e){if(!D(e))throw new TypeError(e+" is not a function");return e},create:function(e){var t=new this;for(var n in e)t[n]=e[n];return t.handlers=[],t.pubs={},t},setHandlers:function(e){this.handlers=e},subscribe:function(e,t){this.callable(t);var n=this,r=(n.pubs||{})[e]||[];if(r)for(var a=0;a<r.length;a++){var o=r[a]();t.apply(n,o)}var i=n.handlers||[];return e in i||(i[e]=[]),i[e].push(t),n.setHandlers(i),n},unsubscribe:function(e,t){this.callable(t);try{var n=this.handlers[e];if(!n)return this;if("object"===v(n)&&n.length>0){for(var r=0;r<n.length;r++)t.toString()===n[r].toString()&&n.splice(r,1);this.handlers[e]=n}else delete this.handlers[e]}catch(a){}return this},publish:function(e){var t=Nn(arguments),n=this.handlers||[],r=n[e]?n[e].length:0;if(r>0)for(var a=0;a<r;a++){var o=n[e][a];D(o)&&o.apply(this,t)}return this},cachePubs:function(e){var t=this.pubs||{},n=Nn(arguments);t[e]||(t[e]=[]),t[e].push((function(){return n}))}}),Ln=ot(Object.freeze({__proto__:null,default:xn})),Un=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){var e=H(q()),t="".concat(q(),"_pubsub");if(!e[t]){var n=Ln.default.create();e[t]=n}}}]),jn=ot(Object.freeze({__proto__:null,default:Un}));function Bn(e,t,n){if(Fe.checkEvent(e,t)){var r=function(e,t){if("string"!=typeof e||!e)return B().w("event logkey is invalid, id =",e||"'' event properties = ",O(t.cusp)),null;var n=Object.create(null),r=Date.now();if(n.id=e,t&&t.ts||(n.ts=r),t&&t.uuid||(n.uuid=Fe.getUUID()),"object"===v(t))for(var a in t)Object.prototype.hasOwnProperty.call(t,a)&&(n[a]=t[a]);return n}(e,t);r.rank=Fe.RankUtils.rank(),r&&r.id===Ie.APP_END&&(r.amount=r.rank),B().i("event: ",e,t),Pt().addEvent(r);var a=H(G()),o=H(q()),i=Ie.MAX_QUEUE_COUNT,s=o.getMetaInfo("max-queue-count");T(s)&&!isNaN(parseInt(s,10))&&(i=parseInt(s,10));var c=o.getMetaInfo(de._ANONY_ID);(e===Ie.APP_END||Pt().getEkvsLen()>=i)&&(n?c?sn.prepare(be,{noCache:!1}):a.push({action:de.SUBSCRIBE,arguments:[de.SET_META_INFO,function(e){e===de._ANONY_ID&&sn.prepare(be,{noCache:!1})}]}):sn.prepare(be,{noCache:!1}))}}var Fn,Kn=F.extend({subscribeLogs:function(e,t){Ce(de.SUBSCRIBE,[e,function(e){e.status===de.COMPLETE&&t(e)}])},getLogicSymbol:function(){return"ALI"===this.format?"&":"||"},handlerMiddleware:function(){},watchLOG:function(){var e=this;e.subscribeLogs(de.MW_CHANGE_PV,(function(t){e.handlerMiddleware(t,"pv")})),e.subscribeLogs(de.MW_CHANGE_HJLJ,(function(t){e.handlerMiddleware(t,q())}))},run:function(){this.watchLOG()}}).extend({handlerMiddleware:function(e){var t,n,r=this.metaInfo&&this.metaInfo.autoGetOpenid,a=$().ctx,o=q(),i=e&&e.userdata&&e.userdata.logkey,s=a[o].getMetaInfo(Ie.APLUS_PRESET_EVENTS_DISABLED);if(!(s&&E.isArray(s)&&i&&i.indexOf("$$_")>-1&&-1!==s.indexOf(i))){var u,p=e&&e.userdata&&e.userdata.gmkey,l=e&&e.what_to_send&&e.what_to_send.logdata&&e.what_to_send.logdata||{},f=a[o].getMetaInfo(Ie.GLOBAL_PROPERTY);if(p===de.CLK||p===de.EXP||p===de.OTHER||i===Ie.APP_START||i===Ie.APP_END){t=b.cloneDeep(e&&e.userdata&&e.userdata.gokey)||{},n=l.gokey||{};var g={};i===Ie.SHARE&&(g.refer_page=l.url,g.share_type=t.share_type,delete t.share_type),n.scene&&(g.scene="".concat(at.getPlatformType(),"_").concat(n.scene)),n.targetAppKey&&(g.targetAppKey=t.targetAppKey,delete t.targetAppKey),u=t.page_name||dn.getPageName(l.url)||l.url||"",g.page_name=u,g.url=l.url||"",g.ref_url="-"!==l.pre?l.pre:"",g.ref_page_name=dn.getPrePageName(dn.getPrePagePath(g.ref_url))||dn.getPrePagePath(g.ref_url),(t.page_name||t["data-pagename"])&&(delete t.page_name,delete t["data-pagename"]),b.isEmptyObject(f)||(g.gp=f),t.spm&&(g["spm-cnt"]=[encodeURIComponent(u),t.spm.c,t.spm.d].filter((function(e){return!!e})).join("."),delete t.spm),t.page_title?(g.page_title=t.page_title,delete t.page_title):g.page_title=n._page_title||dn.getPageTitle(l.url)||"",t.is_auto?(g.is_auto=t.is_auto,g.track_type="1",delete t.is_auto,l.event_code&&(g.event_type_id=l.event_code)):(g.is_auto=0,g.track_type="0"),p!==de.EXP&&p!==de.CLK||["element_type","element_selector","element_path","element_content","element_id","element_name","element_class_name"].forEach((function(e){Object.prototype.hasOwnProperty.call(t,e)&&(g.ap?g.ap[e]=t[e]:g.ap=c({},e,t[e]),delete t[e])})),Bn(i,i===Ie.APP_START||i===Ie.APP_END?b.assign(g,t):b.assign(g,{cusp:t}),r)}else if(l.event_code===de.PV_CODE){var _={},h=Ie.PAGE_START;u=(n=b.cloneDeep(l.gokey)||{}).page_name||dn.getPageName(l.url)||l.url||"",_.r=l.arg1||l.logkey||"-",_.page_name=u,n._page_auto_pv?(_.is_auto=1,_.url=n.path||"",_.ref_url="-"!==n.referrer?n.referrer:"",_.track_type="1",delete n._page_auto_pv,delete n.referrer,delete n.path,delete n.page_name):(_.is_auto=0,_.url=l.url||"",_.ref_url="-"!==l.pre?l.pre:"",_.track_type="0"),n.duration&&(_.duration=n.duration,delete n.duration),b.isEmptyObject(f)||(_.gp=f),n.scene&&(_.scene="".concat(at.getPlatformType(),"_").concat(n.scene)),n=Fe.deleteInfo(n,["_anony_id","_dev_id","_session_id","_user_id","_user_nick","uaid","pvid","scene"]),_["spm-cnt"]=encodeURIComponent(u),n._page_auto_id&&(h=n._page_auto_id,delete n._page_auto_id),n.page_start&&(_.page_start=n.page_start,delete n.page_start),n.page_title?(_.page_title=n.page_title,delete n.page_title):_.page_title=n._page_title||dn.getPageTitle(l.url)||"",delete n._page_title,_.url=dn.getFullPath(_.url),_.ref_url=dn.getFullPath(_.ref_url),_.ref_page_name=dn.getPrePageName(dn.getPrePagePath(_.ref_url))||dn.getPrePagePath(_.ref_url),Bn(h,b.assign(_,{cusp:n}),r)}}},run:function(){this.watchLOG()}}),Vn=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){var e=this.options.context.sdk_config.metaInfo;Kn.create({metaInfo:e}).run(this.options)}}]),$n=ot(Object.freeze({__proto__:null,default:Vn})),qn={};function Gn(){return Fn||(Fn=qn||{},qn)}function Hn(e,t){var n=H(q());return Fn||(Fn={}),"aplus-inject-record-gokey"===e&&(!function(e){try{B().w("the API aplus-inject-record-gokey is deprecated, if needed please concat APLUS SDK supporter")}catch(t){}}(),n.record("/inject.record.gokey","OTHER","")),Fn[e]=t,!0}function Yn(e){return Fn||(Fn={}),Fn[e]||""}function Qn(e,t){if(e&&t){var n,r=function(n){n.constructor===Array?function(n){try{var r="string"==typeof t?JSON.parse(t):t;a(e,n.concat(r))}catch(o){}}(n):function(n){try{var r="string"==typeof t?JSON.parse(t):t;a(e,Object.assign({},n,r))}catch(o){}}(n)},a=function(e,t){Wn(e,t)},o=Yn(e);if("aplus-exinfo"===e&&(a(e,b.assign(o,M(t))),n=!0),"aplus-page-properties"===e){var i=t;if(o)for(var s in o)t[s]?i[s]=b.assign(o[s],t[s]):i[s]=o[s];a(e,i),n=!0}if(o)if("object"===v(o))r(o),n=!0;else try{var c=JSON.parse(o);"object"===v(c)&&(r(c),n=!0)}catch(u){}n||a(e,t)}}function Wn(e,t){var n,r,a="OVERWRITE",o=a;if("object"===v(e)?(n=e.metaName,r=e.metaValue,o=e.mode||a):(n=e,r=t),o!==a)return Qn(n,r);if(Hn(n,r)){var i=Q("_$")||{};i.meta_info=Gn();var s=W("_$",i),c=["setMetaInfo",n,r,{}];return X(c),Z(c),n===de._ANONY_ID||n===de._DEV_ID||n===de._USER_ID?at.setStorageSync(n,r||""):n===Ie.APLUS_SDK_DISABLE?r?(B().w("QuickTracking SDK disabled!!!"),at.setStorageSync(Ie.APLUS_SDK_DISABLE,r)):(B().w("QuickTracking SDK enabled!!!"),at.removeStorageSync(Ie.APLUS_SDK_DISABLE)):(!at.getStorageSync(de._ANONY_ID)&&i.meta_info[de._ANONY_ID]&&at.setStorageSync(de._ANONY_ID,i.meta_info[de._ANONY_ID]),!at.getStorageSync(de._DEV_ID)&&i.meta_info[de._DEV_ID]&&at.setStorageSync(de._DEV_ID,i.meta_info[de._DEV_ID]),!at.getStorageSync(de._USER_ID)&&i.meta_info[de._USER_ID]&&at.setStorageSync(de._USER_ID,i.meta_info[de._USER_ID])),s}}var zn=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){var e=this.options.context&&this.options.context.sdk_config,t=H(q()),n=t._$=t._$||{};for(var r in n.is_terminal=!0,n.send_pv_count=0,n.spm={data:{}},n.meta_info=Gn()||{},t.globalConfig=e.globalConfig,e.metaInfo)Hn(r,e.metaInfo[r]);t._$=n,t.isInternational=function(){return!1}}}]),Jn=ot(Object.freeze({__proto__:null,default:zn})),Xn=s((function e(t){o(this,e),this.options=t}),[{key:"getLogConfig",value:function(){var e={},t=this.options.config.plugins,n=function(n){e[n]={plugins:t[n],context:{}},y(t[n],(function(t){e[n].context[t.name]=t.config||{}}))};for(var r in t)n(r);return e}},{key:"run",value:function(){this.options.context.logConfig=this.getLogConfig(),this.options.context.logConfig.pageLoadTime=this.options.context.PAGE_LOAD_TIME}}]),Zn=ot(Object.freeze({__proto__:null,default:Xn})),er=s((function e(t){o(this,e),this.options=t}),[{key:"getMetaInfo",value:function(){return(Q("_$")||{}).meta_info}},{key:"getAplusWaiting",value:function(){return(this.getMetaInfo()||{})["aplus-waiting"]}},{key:"run",value:function(e,t){var n=this.options.config||{},r=this.getAplusWaiting();if(r&&n.is_auto)switch(r="".concat(this.getAplusWaiting()),this.options.context.when_to_sendpv={aplusWaiting:r},r){case de._USER_ID:case de._ANONY_ID:case"MAN":return"done";case"1":return this.options.context.when_to_sendpv.isWait=!0,setTimeout((function(){t()}),6e3),6e3;default:var a=1*r;if("NaN"!=="".concat(a))return this.options.context.when_to_sendpv.isWait=!0,setTimeout((function(){t()}),a),a}}}]),tr=ot(Object.freeze({__proto__:null,default:er})),nr=s((function e(t){o(this,e),this.options=t}),[{key:"getMetaInfo",value:function(e){return((Q("_$")||{}).meta_info||{})[e]}},{key:"getHostUrl",value:function(){var e=this.getMetaInfo(Ie.TRACKDOMAIN)||this.getMetaInfo(Ie.APLUS_PV_DOMAIN);if(Fe.checkDomain(e)){var t=at.getLogDomain();return t?Fe.fixDomain(e)+t:(B().tip_w("current miniapp framework is not supported!!"),"")}}},{key:"run",value:function(){this.options.context.where_to_send.method=Oe.POST;var e=this.getHostUrl();if(!e||e.indexOf("https://")<0&&e.indexOf("http://"))return B().w("current trackDomain invalid: ".concat(e)),"done";this.options.context.where_to_send.url=e}}]),rr=ot(Object.freeze({__proto__:null,default:nr}));function ar(e,t,n){return e?Fe.hash(encodeURIComponent(e)).substring(0,t):n}var or=function(e,t){var n=function(e){var t,n="",r=!1;function a(e){return 1===e?"0123456789abcdefhijklmnopqrstuvwxyzABCDEFHIJKLMNOPQRSTUVWXYZ".substring(Math.floor(60*Math.random()),1):2===e?"0123456789abcdefghijkmnopqrstuvwxyzABCDEFGHIJKMNOPQRSTUVWXYZ".substring(Math.floor(60*Math.random()),1):"0"}for(;n.length<8;)t="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ".substring(Math.floor(62*Math.random()),1),!r&&n.length<=2&&("g"===t.toLowerCase()||"l"===t.toLowerCase())&&(0===n.length&&"g"===t.toLowerCase()?Math.random()<.5&&(t=a(1),r=!0):1===n.length&&"l"===t.toLowerCase()&&"g"===n.charAt(0).toLowerCase()&&(t=a(2),r=!0)),n+=t;return n}(),r=n.substring(0,4),a=n.substring(0,6);return[ar(e,4,r),ar(t,4,r),a].join("")},ir=de.SPM_CNT,sr=de.SPM_URL,cr=de.SPM_PRE,ur=s((function e(t){o(this,e),this.options=t}),[{key:"getCommonParams",value:function(){var e=H(q()),t=this.options.context||{},n=t.etag||{},r=t.userdata||{},a=Q("_$")||{},o=a.spm||{},i=this.options.config||{},s=e.getMetaInfo("platformType")||at.getPlatformType(),c={_dev_id:e.getMetaInfo("_dev_id"),_anony_id:e.getMetaInfo(de._ANONY_ID),_user_id:e.getMetaInfo(de._USER_ID),_user_nick:e.getMetaInfo("_user_nick"),_session_id:e.getMetaInfo("_session_id"),uaid:"1"==="".concat(e.getMetaInfo("uaid"))?1:0},u=e._aplus_client||{},p=e.globalConfig||{},l="";try{var f=getCurrentPages(),g=f[f.length-1]||{};l=r.gokey&&r.gokey.currentPath||g.route||g.is,r.gokey.currentPath&&delete r.gokey.currentPath}catch(S){}var _=(new Date).getTime()+l,h=u.model+u.networkType+i.title+n.cna,d=(p.isDecodeUrl?"DC_":"")+or(_,h),m=Fe.getAppKey();m||B().w("please set appKey in aplus metaInfo before sendPV!");var v=Object.assign({},{appKey:m,cache:d,cna:n.cna,etag:n,pre:a.page_referrer||"-",sdk_info:{jsver:p.script_name,skv:p.lver,customSdkId:e.getMetaInfo("customSdkId")||"",platformType:s.toLowerCase()},title:i.title||"",url:l,client:u,timeZone:Fe.getTimeZone(),gmkey:r.gmkey||"",method:this.options.context.where_to_send.method},c),y=c;return o.spm_url&&(y[sr]=o.spm_url||""),o.spm_pre&&(y[cr]=o.spm_pre||""),o.spm_cnt&&(y[ir]=o.spm_cnt||""),y[de.PVID]=e.pvid||"",v.sessionArgs=e.getMetaInfo("aplus-session-args"),v.globalArgs=e.getMetaInfo("aplus-global-args"),v.gokey=y,v}},{key:"getPvParams",value:function(){var e=H(q()),t=this.getCommonParams();return this.options.config.is_auto||(t.sdk_info.mansndlog=1),Object.assign({},t,{event_code:de.PV_CODE,logtype:"1",logkey:"/vx.gif",event_timestamp:e._$.send_pv_count>0?new Date:e.logConfig.pageLoadTime})}},{key:"getHjljParams",value:function(){var e=(this.options.context||{}).userdata||{},t={event_code:ve[e.gmkey]||e.gmkey,logkey:e.logkey,event_timestamp:new Date};return Object.assign({},this.getCommonParams(),t)}},{key:"run",value:function(){var e;e="PV"===this.options.config.recordType?this.getPvParams():this.getHjljParams(),this.options.context.what_to_send.logdata=e}}]),pr=ot(Object.freeze({__proto__:null,default:ur})),lr=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){var e=at.isTB(),t=H(q()),n=this.options.context.what_to_send.logdata||{},r=getCurrentPages(),a=r[r.length-1]||{};a&&!n.title&&(n.title=a.route||"");var o="-";if(r.length>1){var i=r[r.length-2]||{};o=(!e&&t.globalConfig.isAli?"https://".concat(n.client.appId,"_"):"")+(i.route||i.is||"-")}n.pre=o,n.sdk_info&&(n.sdk_info.windmill="1"),this.options.context.what_to_send.logdata=n}}]),fr=ot(Object.freeze({__proto__:null,default:lr})),gr=s((function e(t){o(this,e),this.options=t}),[{key:"getUserdata",value:function(){var e=H(q()),t=this.options.config||{},n={};t&&!t.is_auto&&t.gokey&&("string"==typeof t.gokey?n=M(t.gokey):"object"===v(t.gokey)&&(n=t.gokey));var r=function(e){E.isArray(e)?e.forEach((function(e){n=Object.assign({},n,e)})):n=Object.assign({},n,e)};r(e.getMetaInfo("aplus-cpvdata"));var a=at.getCurrentPage(),o=a.route||a.is||"page",i=(e.getMetaInfo("aplus-page-properties")||{})[o];return"object"===v(i)&&r(i),r((this.options.context||{}).userdata||{}),n}},{key:"updatePre",value:function(e){var t=this.options.config||{},n=Q("_$")||{};return t&&t.referrer&&(n.page_referrer=t.referrer,e.pre=t.referrer),W("_$",n),e}},{key:"updateUrl",value:function(e){var t=this.options.config||{};return t&&t.pageUrl&&(e.url=t.pageUrl),e}},{key:"updateSpmUrl",value:function(e){var t=this.options.config||{},n=t[de.SPM_URL]||t.spmUrl;return k(n)||(e.gokey[de.SPM_URL]=n),e}},{key:"updateSpmPre",value:function(e){var t=this.options.config||{},n=t[de.SPM_PRE]||t.spmPre;return k(n)||(e.gokey[de.SPM_PRE]=n),e}},{key:"run",value:function(){var e=this.options.context.what_to_send.logdata,t=Object.assign({},this.getUserdata(),e.userdata||{});e.gokey=Object.assign({},e.gokey,t),e=this.updatePre(e),e=this.updateUrl(e),e=this.updateSpmUrl(e),e=this.updateSpmPre(e),this.options.context.what_to_send.logdata=e,this.options.context.userdata=e.gokey}}]),_r=ot(Object.freeze({__proto__:null,default:gr})),hr={parseSemicolonContent:function(e,t,n){t=t||{};var r,a,o=e.split(";"),i=o.length;for(r=0;r<i;r++){a=o[r].split("=");var s=U.trim(a.slice(1).join("="));t[U.trim(a[0])||""]=n?s:this.tryToDecodeURIComponent(s)}return t},getLsCna:function(e,t){if(xe.get&&xe.test()){var n="",r=xe.get(e);if(r){var a=r.split("_")||[];n=t?a.length>1&&t===a[0]?a[1]:"":a.length>1?a[1]:""}return decodeURIComponent(n)}return""},setLsCna:function(e,t,n){n&&xe.set&&xe.test()&&xe.set(e,"".concat(t,"_").concat(encodeURIComponent(n)))},getLsImpv:function(e,t){if(xe.get&&xe.test()){var n="",r=xe.get(e);if(r){var a=r.split("||")||[];n=t?a.length>1&&t===a[0]?a[1]:"":a.length>1?a[1]:""}return decodeURIComponent(n)}return""},setLsImpv:function(e,t,n){n&&xe.set&&xe.test()&&xe.set(e,"".concat(t,"||").concat(encodeURIComponent(n)))},setLsRemoteCfg:function(e,t,n){if(n&&xe.set&&xe.test()){var r=b.cloneDeep(n);"object"===v(r)&&(r=JSON.stringify(r)),xe.set(e,"".concat(t,"||").concat(encodeURIComponent(r)))}},getLsRemoteCfg:function(e,t){if(xe.get&&xe.test()){var n="",r=xe.get(e);if(r){var a=r.split("||")||[];n=t?a.length>1&&t===a[0]?a[1]:"":a.length>1?a[1]:""}return w(decodeURIComponent(n))}return""}},dr="mini",mr="web";function vr(e,t){var n,r=H(q());if(t===dr?n=At().getSync(Ie.APLUS_REMOTE_CONFIG):t===mr&&(n=hr.getLsRemoteCfg(Ie.APLUS_REMOTE_CONFIG)),n){var a=r.getMetaInfo(Ie.APLUS_EVENT_LIMITRATES)||Fe.mapEventSampleRates(n.eventSamplingRate);if(a&&a.length>0){var o=E.find(a,(function(t){return t.eventId===e}));if(o&&Math.ceil(1e3*Math.random())>1e3*o.samplingRate)return!0}}return!1}function yr(e){var t=H(q()).getMetaInfo(Ie.APLUS_PRESET_EVENTS_DISABLED);if(t&&E.isArray(t)&&e&&e.indexOf("$$_")>-1&&-1!==t.indexOf(e))return!0}function Sr(){try{return!!at.getStorageSync(Ie.APLUS_SDK_DISABLE)}catch(dt){B().e("check sdk disable condition failed, errmsg = ",dt)}}var Er=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){var e=Q("_$")||{},t=this.options.context.can_to_sendpv||{},n=e.send_pv_count||0,r=this.options.config||{},a=at.getCurrentPage(),o=a.route||a.is,i=this.options.context.userdata.page_name||dn.getPageName()||o;if(!function(e,t){return!Sr()&&function(e,t,n){var r=Ot(),a=wt(),o=Fe.LocalCfgUtils.localAutoPVDisabled();return!(!r||yr(Ie.PAGE_START)||vr(t,n)||e&&(a?2===a:o))}(e,t,dr)}(r.track_type,i))return"done";t.flag="YES",this.options.context.can_to_sendpv=t,e.send_pv_count=++n,W("_$",e)}}]),Ar=ot(Object.freeze({__proto__:null,default:Er})),Ir=s((function e(t){o(this,e),this.options=t}),[{key:"getUserData",value:function(){var e=H(q()),t=this.options.context||{},n=t.userdata||{},r=t.what_to_send.logdata.gokey;r=b.assign(r,M(n.gokey)),r=b.assign(r,M(e.getMetaInfo("aplus-exinfo")||{}));var a=e.getMetaInfo("aplus-exdata");return E.isArray(a)?a.forEach((function(e){r=b.assign(r,e)})):r=b.assign(r,a||{}),r}},{key:"run",value:function(){var e=this.options.context.what_to_send.logdata,t=this.getUserData();"1010"===e.gmkey&&(e.arg1=t.duration||e.logkey),e.gokey=t,this.options.context.what_to_send.logdata=e}}]),Pr=ot(Object.freeze({__proto__:null,default:Ir})),br="æ”¶æ•°åŸŸåè®¾ç½®é”™è¯¯",Tr=function(e,t,n,r){try{var a=t.url;if(e&&e.code===Te.OK){var o,i=e.data.shareId;if(o=r?{path:a.indexOf("?")>-1?"".concat(a,"&$sid=").concat(i):"".concat(a,"?$sid=").concat(i),$soriPath:a,title:t.title,$sid:i,$scampaign:t.meta&&t.meta.campaignId}:{$sid:i},!n||!D(n))return o;n(o)}else{if(B().e(new Error(e.message)),!n||!D(n))return{};n()}}catch(s){if(B().e(new Error(s.message)),!n||!D(n))return{};n(new Error(s.message))}},Or=F.extend({_send:function(e,t,n,r,a){return"object"===v(t)&&n===Oe.POST?at.request(e,{method:n,data:t,dataType:"base64"},r,a):at.request("".concat(e,"?").concat(t),{method:n,dataType:"base64"},r,a),e},_requestVTConfig:function(e,t,n){at.request(e,{method:Oe.GET,dataType:"json"},t,n)},_requestRemoteConfig:function(e,t,n){at.request(e,{method:Oe.GET,dataType:"json"},t,n)},_sendPV:function(e,t){var n=H(q()),r=e||{};r.pageName&&n._setMetaInfo("".concat(Ie.APLUS,"-pagename"),r.pageName);var a=new re;r.recordType="PV",r.method||(r.method=Oe.GET);var o=n.logConfig.pv;return a.run({plugins:o.plugins,context:b.cloneDeep(o.context)},{config:r,userdata:t||{},pubsubType:"pv",middlewareMessageKey:"mw_change_pv"}),!0},_combineRecord:function(e,t,n,r){var a=H(q()),o=r||Oe.POST;if(!a.globalConfig.isAli||t!==de.EXP&&t!==de.CLK)B().w("only support EXP or CLK log to combile record!");else if(E.isArray(n)){var i=[],s="true";n.forEach((function(e){i.push({exargs:"object"===v(e.exargs)?e.exargs:{},scm:e.scm,spm:e.spm,aplusContentId:e.aplusContentId}),"false"===e._aplus_sendtomy&&"true"===s&&(s="false")}));var c=[];c.push((t===de.EXP?"expdata=":"clkdata=")+JSON.stringify(i)),c.push(t===de.EXP?"_is_auto_exp=1":"_is_auto_clk=1"),c.push("_eventType=custom"),c.push("_method=".concat(r)),c.push("_pkgSize=".concat(n.length)),"false"===s&&c.push("_aplus_sendtomy=false"),a.record(e,t,c.join("&"),o)}else B().w("type of gokeys must be ArrayObject!")},_record:function(e,t,n,r,a){var o,i=H(q());return(o=J())&&v(o.subscribe)===z&&o.subscribe("aplusInitContext",(function(o){if("complete"===o.status){n=function(e){var t=Yn("aplus-inject-record-gokey");return"function"==typeof t?t(e):e.gokey}({logkey:e,gmkey:t,gokey:n}),e+="";var s=new re,c=i.logConfig.hjlj;(function(e,t){return!Sr()&&function(e,t,n){if(!Ot())try{var r=at.getPlatformContext();return b.isEmptyObject(r)?void 0:t===Ie.APP_START||t===Ie.APP_END}catch(s){}var a=Ct(),o=Tt(),i=Fe.LocalCfgUtils.getAutoTrackStatus();if(("string"==typeof e?R(L(e)):e||{}).auto_element){if(2===o||2===a)return;if("number"==typeof a)return a;if("boolean"==typeof a&&!a)return;if(!i)return}return!yr(t)&&(!vr(t,n)||void 0)}(e,t,dr)})(n,e)&&s.run({plugins:c.plugins,context:b.cloneDeep(c.context)},{config:{recordType:"COMMON_HJLJ",method:r||Oe.GET},userdata:{logkey:e,gmkey:t,gokey:n},pubsubType:"hjlj",middlewareMessageKey:"mw_change_hjlj"},(function(){D(a)&&a()}))}})),!0},getPageSPM:function(){var e=((H(q())._$||{}).spm||{}).data||{};return[e.a,e.b]},_setPageSPM:function(){var e,t,n={},r=arguments;"object"===v(r[0])?(n=r[0],e=r[1]):(n.spmCnt=[r[0],r[1],"0","0"].join("."),e=r[2]),n.spmCnt||n.spmUrl||!Yn("pageConfig")?(X(t=["setPageSPM",n]),Z(t)):(X(t=["clearPageSPM"]),Z(t)),("function"==typeof e?e:function(){})(t)},_setMetaInfo:function(e,t){return Wn(e,t)},_appendMetaInfo:Qn,getMetaInfo:function(e){return Yn(e)},cloneDeep:b.cloneDeep,_setPageName:function(e,t){if(e){var n=t||dn.getCurrentPagePath(),r=b.cloneDeep(Yn("pageConfig")||{});r[n]=e,Qn("pageConfig",r)}else B().w("setPageName failed: pageName=".concat(e))},getPageName:function(e){return dn.getPageName(e)},_getElementSPM:function(e,t){if(e){var n=dn.getPageName()||"";if("string"!=typeof e){var r=e.dataset&&e.dataset.trackerParams||"",a=C(r);return[n,a.spmC,a.spmD].join(".")}var o,i=at.getPlatformContext(),s=Yn("aplus-auto-clk")||[],c=Yn("aplus-auto-exp")||[];try{var u;for(u=0;u<s.length;u++){var p=s[u];if(p.cssSelector===e){o=[p.spmB||n,p.spmC,p.spmD].join(".");break}}for(u=0;u<c.length;u++){var l=c[u];if(l.cssSelector===e){o=[l.spmB||n,l.spmC,l.spmD].join(".");break}}var f=i.createSelectorQuery().selectAll(e);"function"==typeof f.fields&&f.fields({dataset:!0,id:!0},(function(e){var n=[];if(e&&e.length>0){for(var r=1;r<=e.length;r++)n.push("".concat(o,"_").concat(r));t&&"function"==typeof t&&t(n)}})).exec()}catch(g){B().w("current miniapp platform does not support dom element query, errmsg: ",g)}}},_recordAppLink:function(e,t,n){return e.targetAppKey?H(q())._record("$$_app_link","OTHER",e,t,n):(B().w("send $$_app_link failed: targetAppKey is null"),!1)},_updatePageProperties:function(e,t){var n,r=t||dn.getCurrentPagePath(),a=H(q()).getMetaInfo(Ie.PAGE_CONFIG);if(!b.isEmptyObject(e))if(a&&a[r])a[r].properties=e,n=a;else{var o=Object.create(null);o[r]={properties:e},n=o}n&&Qn(Ie.PAGE_CONFIG,n)},_reportUserInfo:function(e,t){var n={};e&&("string"==typeof e?n._user_email=e:B().w("è¯·è¾“å…¥æ­£ç¡®ç±»åž‹çš„ user_email")),t&&("string"==typeof t?n._user_mobile=t:B().w("è¯·è¾“å…¥æ­£ç¡®ç±»åž‹çš„ user_mobile")),Object.keys(n).length&&H(q()).record("$$_user_profile","OTHER",n)},requestShareParams:function(e,t){var n=e.path||at.getCurrentPage().route;U.isStartWith(n,"/")||(n="/".concat(n));var r,a,o=function(){var e=H(q()),t=e.getMetaInfo(Ie.TRACKDOMAIN)||e.getMetaInfo(Ie.APLUS_PV_DOMAIN);if(Fe.checkDomain(t))return"".concat(Fe.fixDomain(t),"/share/getShareId")}(),i=function(e,t,n,r){var a=e.path,o=e.campaign,i=e.title,s=e.shareId;if(a||B().w("åˆ†äº«é“¾æŽ¥ï¼ˆpathï¼‰ä¸ºç©ºï¼Œé»˜è®¤åˆ†äº«é“¾æŽ¥ä¸ºå½“å‰é¡µé¢è·¯å¾„"),o&&U.isString(o)&&o.length>=4096)B().e("åˆ†äº«æ´»åŠ¨ï¼ˆcampaignï¼‰å­—ç¬¦ä¸²é•¿åº¦ä¸èƒ½è¶…è¿‡ 4*1024");else{if(!(i&&U.isString(i)&&i.length>=4096)){var c=H(q()),u=c.getMetaInfo(Ie.APPKEY),p="mini"===r?c.getMetaInfo(de._ANONY_ID):c.getMetaInfo(de._DEV_ID),l=c.getMetaInfo(de._USER_ID),f={meta:{campaignId:o||""},shareId:s,shareTitle:i,url:n,ts:Date.now(),umid:p,puid:l,sharePlatform:t,appkey:u};return B().i("before requestShareParams: \n ".concat(JSON.stringify(f)," \n")),f}B().e("åˆ†äº«æ ‡é¢˜ï¼ˆtitleï¼‰å­—ç¬¦ä¸²é•¿åº¦ä¸èƒ½è¶…è¿‡ 4*1024")}}(e,at.getPlatformType(),n,dr);if(o){if(!D(t))return r=o,a=i,at.requestPromise(r,{data:a,dataType:"object",timeout:Ie.DEFAULT_REQUEST_TIMEOUT,method:Oe.POST}).then((function(e){try{var t=JSON.parse(e.data);return Tr(t,a,null,!0)}catch(n){return B().e(new Error("parse share response error")),{}}})).catch((function(e){return B().e(new Error(e.errMsg)),{}}));!function(e,t,n){at.request(e,{data:t,dataType:"object",timeout:Ie.DEFAULT_REQUEST_TIMEOUT,method:Oe.POST},(function(e){try{var r=JSON.parse(e.data);Tr(r,t,n,!0)}catch(a){B().e(new Error("parse share response error"))}}),(function(e){var t=new Error(e.msg);B().e(t),n&&n(t)}))}(o,i,t)}else{if(!D(t))return B().e(new Error(br)),{};t(new Error(br))}},getRefShareParams:function(){var e=H(q()).getMetaInfo(Ie.GLOBAL_PROPERTY)||{};return{$$_ref_share_url:e[Ie.REF_SHARE_URL]||"",$$_ref_share_id:e[Ie.REF_SHARE_ID]||""}},disableSDK:function(){try{at.setStorageSync(Ie.APLUS_SDK_DISABLE,!0),B().w("QuickTracking SDK disabled!!!")}catch(dt){B().e("disable sdk failed, errormsg: ",dt)}},enableSDK:function(){try{at.removeStorageSync(Ie.APLUS_SDK_DISABLE),B().w("QuickTracking SDK enabled!!!")}catch(dt){B().e("enable sdk failed, errormsg: ",dt)}}}),wr={run:Or},Cr=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){!function(e){var t=H(q());if(!t._aplus_api){t._aplus_api={status:de.COMPLETE};var n=wr.run.create({logConfig:e});for(var r in n)t[r]=n[r];Y(q(),t);var a=[de.SDK_READY,de.COMPLETE];X(a),Z(a)}}(this.options.context.logConfig)}}]),Dr=ot(Object.freeze({__proto__:null,default:Cr})),kr=function(e,t){var n=e;"object"===v(t)&&t.message&&(n="".concat(n,"_").concat(t.message)),Ce("".concat(q(),"._aplus_cplugin_m.do_tracker_jserror"),[{message:n,error:JSON.stringify(t),filename:e}])},Rr={lsMinivtConfigKey:"APLUS_MINI_CONFIG",getMiniVtTplCdnPath:function(){var e=H(q()).getMetaInfo("aplus-track-config-id"),t=e&&e.turnon,n=e&&e.value;return"1"===t&&n?n:""},getVtConfigPath:function(){var e=this.getMiniVtTplCdnPath();if(e){var t,n=[],r=Fe.getAppKey();return r&&(t=r),t&&(n=t.split(".")),2===n.length?this.originSpm={spmA:n[0],spmB:n[1]}:1===n.length&&(this.originSpm.spmA=n[0]),e||(2===n.length?n.join("_"):1===n.length?n[0]:void 0)}},fetchFromLS:function(e){this.cdnpath||(this.cdnpath=e||this.getMiniVtTplCdnPath());var t=at.getPlatformContext(),n="".concat(this.lsMinivtConfigKey,"-").concat(this.cdnpath);try{return decodeURIComponent(t.getStorageSync(n))}catch(r){return{}}},setConfigIntoLs:function(e){this.cdnpath||(this.cdnpath=this.getVtConfigPath()),at.getPlatformContext().setStorageSync("".concat(this.lsMinivtConfigKey,"-").concat(this.cdnpath),encodeURIComponent(JSON.stringify(e)))}},Mr="MiniVtConfigBack",Nr=de.PUBLISH,xr=F.extend(b.assign(Rr,{pathname:"",pageConfig:{},originSpm:{spmA:"",spmB:""},updateCfgLs:function(){var e=this;setTimeout((function(){e.fetchFromCdn()}),1e3)},fetchFromCdn:function(){var e=this,t=H(q()),n=t.getMetaInfo("aplus-vt-cfg-url");if(n){var r=(new Date).getTime();t.requestVTConfig(n,(function(n){var a=n.data;if(t._minicfg_load=(new Date).getTime()-r,a)try{t._aplus_vt_cfg="object"===v(a)?a:JSON.parse(a),t._aplus_vt_cfg.points&&E.each(t._aplus_vt_cfg.points,(function(e){e.selector=decodeURIComponent(e.selector)})),e.setConfigIntoLs(t._aplus_vt_cfg)}catch(o){t._aplus_vt_cfg={enabled:!1}}Ce(Nr,[Mr,{pageConfig:t._aplus_vt_cfg,enable:0}])}),(function(e){t._aplus_vt_cfg&&t._aplus_vt_cfg.enabled&&Ce(Nr,[Mr,{pageConfig:t._aplus_vt_cfg,enable:0}]),kr("getTrackerCfg",e,{msg:n})}),{timeout:5e3})}},getMiniVtData:function(e,t,n){var r=H(q());if(r._minicfg_load=0,e){var a=this.fetchFromLS(e);if("string"==typeof a)try{a=JSON.parse(a)}catch(o){a={}}a&&a.enabled&&(r._aplus_vt_cfg=a),n?this.fetchFromCdn(e,t):Ce(Nr,[Mr,{pageConfig:a,enable:0}])}},syncMiniVtData:function(){var e=this.getVtConfigPath();e&&this.getMiniVtData(e,"",!0)},init:function(){var e=this,t=de.SUBSCRIBE;Ce(t,[Mr,function(t){t.enable||(e.pageConfig=t.pageConfig),Ce(Nr,["MiniVtConfigFormat",{pageConfig:e.pageConfig,originSpm:e.originSpm}]),!t.enable&&e.setConfigIntoLs(e.pageConfig)}]),e.syncMiniVtData()},run:function(){return this.init(),this}}));function Lr(e,t){return e=E.isArray(e)?e:[],t=E.isArray(t)?t:[],[].concat(t,e).filter((function(e,t,n){return function(e,t){for(var n=-1,r=0;r<t.length;r++){var a=t[r];if(a.cssSelector===e.cssSelector&&a.logkey===e.logkey){n=r;break}}return n}(e,n)===t}))}function Ur(e){return E.isArray(e)?e.filter((function(e){return void 0===e._vt})):[]}function jr(e){return/^[.#]/.test(e)?e:e?".".concat(e):""}function Br(){var e,t,n,r,a,o=H(q()),i=o._aplus_vt_cfg||o._aplus_tracking_cfg;if(i&&i.pages){var s=(e=at.getCurrentPage().route,t=H(q()),n=t._aplus_vt_cfg||t._aplus_tracking_cfg,r=[],a=[],n&&n.pages&&E.each(n.pages,(function(o){t.setPageName({pageName:o.spmB,extraParams:o.extraParams},o.matchUrl),o.matchUrl===e&&(E.each(n.points,(function(e){o.spmB===e.spmB&&("exposure"===e.trackerType?r.push({cssSelector:jr(e.selector),positionSelector:e.positionSelector,logkey:e.logkey,props:e.props,spmB:e.spmB,spmC:e.spmC,spmD:e.spmD,customArgs:e.customArgs,_vt:o.template||o.stdId?2:1}):a.push({cssSelector:jr(e.selector),logkey:e.logkey,props:e.props,spmB:e.spmB,spmC:e.spmC,spmD:e.spmD,customArgs:e.customArgs,_vt:o.template||o.stdId?2:1}))})),n.common_exdata&&"object"===v(n.common_exdata)&&t.setMetaInfo("aplus-exdata",n.common_exdata),n.common_pvdata&&"object"===v(n.common_pvdata)&&t.setMetaInfo("aplus-cpvdata",n.common_pvdata))})),{EXP:r,CLK:a}),c=Ur(o.getMetaInfo("aplus-auto-exp"));o.setMetaInfo("aplus-auto-exp",Lr(c,s.EXP));var u=Ur(o.getMetaInfo("aplus-auto-clk"));o.setMetaInfo("aplus-auto-clk",Lr(u,s.CLK))}}var Fr="wechat";var Kr=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){var e=H(q());!function(){var e,t,n,r=$().ctx,a=H(q()),o="".concat(q(),"_pubsub"),i=G(),s=!1,c={ts:Date.now()};function u(){var a,o=arguments.length>0&&arguments[0]?arguments[0]:"",u=arguments.length>1&&arguments[1]?arguments[1]:{},p=u.route||"",l=at.getCurrentPage(),f=p||l.route||l.is;switch(o){case"onPullDownRefresh":r[i].push({action:Pe.record,arguments:[t.logkey||Ie.PULL_DOWN_REFRESH,de.CLK,{event:o,page_name:dn.getPageName()||f,is_auto:1}]});break;case"onReachBottom":r[i].push({action:Pe.record,arguments:[e.logkey||Ie.REACH_BOTTOM,de.CLK,{event:o,page_name:dn.getPageName()||f,is_auto:1}]});break;case"onShareAppMessage":u.promise?u.promise.then((function(e){return e?r[i].push({action:Pe.record,arguments:[n.logkey||Ie.SHARE,de.CLK,{event:o,page_name:dn.getPageName()||f,share_type:1,is_auto:1,$$_share_title:e.title||u.title||"",$$_share_from:u.from||"",$$_share_url:e.$soriPath||"",$$_share_id:e.$sid||"",$$_share_campaign_id:e.$scampaign||"",$$_share_type:Fr}]}):B().w("share event promise result is invalid"),e})).catch((function(e){B().e("share event promise handle error: ",e.msg)})):r[i].push({action:Pe.record,arguments:[n.logkey||Ie.SHARE,de.CLK,{event:o,page_name:dn.getPageName()||f,share_type:1,is_auto:1,$$_share_title:u.title||"",$$_share_from:u.from||"",$$_share_type:Fr,$$_share_url:u.$$_share_url,$$_share_id:u.$$_share_id,$$_share_campaign_id:u.$$_share_campaign_id}]});break;case"onShareTimeline":r[i].push({action:Pe.record,arguments:[n.logkey||Ie.SHARE,de.CLK,{event:o,page_name:dn.getPageName()||f,share_type:0,is_auto:1,$$_share_title:u.title||"",$$_share_type:"wemom",$$_share_url:u.$$_share_url,$$_share_id:u.$$_share_id,$$_share_campaign_id:u.$$_share_campaign_id}]});break;case"onAddToFavorites":r[i].push({action:Pe.record,arguments:[n.logkey||Ie.ADD_TO_FAVORITE,de.CLK,{page_name:dn.getPageName()||f,is_auto:1,$$_favorite_title:u.title||""}]});break;case"onPageShow":f&&!s&&((c={path:f}).ts=Date.now(),s=!0);break;case"onPageHide":if(s){var g=Date.now()-c.ts||0,_=at.getReferrerPage().route||at.getReferrerPage().is||"-",h=dn.getPageProperties(c.path)||{},d=b.assign(h,{duration:g,path:c.path,page_name:h.page_name||dn.getPageName()||c.path,page_start:c.ts,isMini:!0,_page_auto_id:Ie.PAGE_END,_page_auto_pv:!0,referrer:_});dn.skipPage(c.path)||(a=d,r[i].push({action:Pe.sendPV,arguments:[{is_auto:!0,track_type:"1"},a]})),c=null,s=!1}}}r[i].push({action:de.SUBSCRIBE,arguments:[de.SDK_READY,function(r){"complete"===r&&(e=a.getMetaInfo("rb_config"),t=a.getMetaInfo("pdr_config"),n=a.getMetaInfo("share_config"))}]}),a[o].subscribe("onLoad",(function(e){if("ready"===e.status)try{var t=dn.getVTRealtimeCode();t?function(e,t){if(e&&t)try{var n=a.getMetaInfo("aplus-api-host"),r=n.match(/[[a-z|\-|\_|0-9\.]+[a-z|\-|\_|0-9](:\d*)?/);if(r&&r[0]){var o=de.HTTPS;/(\d+\.){3,}\d+/.test(r[0])&&(o="http:");var i="".concat(o,"//").concat(n,"/vt/loadTransferConfig?code=").concat(e,"&appInfoId=").concat(t);at.request(i,{},(function(e){try{var t=e.data&&e.data.data&&e.data.data.config||"",n=e.data&&e.data.data&&e.data.data.debugId||"";n&&a.appendMetaInfo("aplus-global-args",{debugId:n});var r=Date.now();a._minicfg_load=Date.now()-r,t&&(a._aplus_vt_cfg=JSON.parse(t)||{},Br())}catch(o){B().w("fetch real-time visualization verification failed, err msg:".concat(o))}}))}}catch(s){}}(t,a.getMetaInfo("appInfoId")):a.getMetaInfo("aplus-vt-cfg-url")&&Br()}catch(n){B().w("fetch real-time visualization verification failed, errmsg:".concat(n))}})),a[o].subscribe("onShow",(function(e){"ready"===e.status&&u("onPageShow",e)})),a[o].subscribe("onHide",(function(e){"ready"===e.status&&u("onPageHide",e)})),a[o].subscribe("onPullDownRefresh",(function(e){"ready"===e.status&&u("onPullDownRefresh")})),a[o].subscribe("onReachBottom",(function(e){"ready"===e.status&&u("onReachBottom")})),a[o].subscribe("onShareAppMessage",(function(e){"ready"===e.status&&u("onShareAppMessage",e)})),a[o].subscribe("onShareTimeline",(function(e){"ready"===e.status&&u("onShareTimeline",e)})),a[o].subscribe("onAddToFavorites",(function(e){u("onAddToFavorites",e)})),a.getMetaInfo("aplus-vt-cfg-url")&&Ce(de.SUBSCRIBE,["MiniVtConfigFormat",function(e){var t=e.pageConfig;t&&t.enabled&&(a._aplus_vt_cfg=t)}])}(),e._aplus_aleady_load_minivt||(e._aplus_aleady_load_minivt=1,xr.create().run())}}]),Vr=ot(Object.freeze({__proto__:null,default:Kr}));function $r(e,t){var n="";try{var r=Number(e);n=parseFloat(r.toFixed(t))}catch(a){n=e}return n}var qr=function(e,t,n,r,a,o){var i=H(q()),s=n.props,c={},u={};if(t)for(var p in t)p.toLowerCase().match(/^data-/)?u[p.toLowerCase().replace(/^data-/,"").replace(/-/g,"")]=t[p]:u[p]=t[p];if(s&&E.isArray(s))for(var l=0;l<s.length;l++){var f=s[l].toLowerCase().replace(/^data-/,"").replace(/-/g,"");c[f]=u[f]}r&&e===de.EXP&&(c=Object.assign({},c,{_w:$r(r.width,2),_h:$r(r.height,2),_x:$r(r.x,2),_y:$r(r.y,2),_rate:$r(r.viewabilityRate||r.intersectionRatio,2),_viewability:"intersection"})),n._vt&&(c._vt=n._vt);var g=function(e,t,n,r){var a=H(q()).getMetaInfo;if("function"==typeof a){var o=a(e),i={};return"function"==typeof o&&(i=o(t?b.cloneDeep(t):{},n,r)),j.query2obj(i)}return{}}(e===de.EXP?"aplus-auto-exp-userfn":"aplus-auto-clk-userfn",r,n.cssSelector,a);g.spm||(g.spm=a&&a.b?a:void 0);var _,h=t.trackerParams||t["tracker-params"];if(h)try{var d=JSON.parse(h);delete(c=Object.assign(c,d)).trackerParams,delete c.trackerparams}catch(v){}if(_=Object.assign({is_auto:1},c,g,n.customArgs),o){var m=o.route;i.record(n.logkey,e,Object.assign({},_,{currentPath:m}),Oe.POST)}else i.record(n.logkey,e,_,Oe.POST)};function Gr(e,t){var n=(Q("_aplus_auto_exp")||{}).hashMap||{};for(var r in n)for(var a=n[r]||[],o=0;o<a.length;o++){var i=a[o]||{},s=i.expConfig||{};if(e.cssSelector===s.cssSelector&&Fe.getHashKey({index:t},s)===i.hash_value)return b.cloneDeep(i.dataset)}}function Hr(){var e=$().ctx,t=H(q()),n=G(),r=[];e[n].push({action:de.SUBSCRIBE,arguments:[de.SDK_READY,function(e){"complete"===e&&(r=t.getMetaInfo("aplus-auto-clk"))}]}),e[n].push({action:de.SUBSCRIBE,arguments:["onAplusClk",function(e){"ready"===e.status&&function(e){r=t.getMetaInfo("aplus-auto-clk");var n=dn.getPageName(),a=[];function o(t,n){E.isArray(t)&&a.push({config:n,elements:t}),a.length===r.length&&function(e,t,n){var r,a=[];function o(e,t){var n={};e&&(e.changedTouches?n=e.changedTouches[0]:e.touches?n=e.touches[0]:e.detail&&(n=e.detail));var r=n.clientX||0,a=n.clientY||0,o=t.top,i=t.bottom;return t.scrollTop&&(o+=t.scrollTop,i+=t.scrollTop),t.left<r&&r<t.right&&o<a&&a<i}E.each(t,(function(t){for(var n=t.elements,r=t.config,i=0;i<n.length;i++){var s=n[i];if(o(e,s)){var c=i+1,u=s.dataset||Gr(r,c)||{},p={},l=C(u.trackerParams)||{};p.b=r.spmB,r.spmC?p.c=r.spmC:p.c=l.spmC?encodeURIComponent(l.spmC):"",r.spmD?p.d=c?"".concat(r.spmD,"_").concat(c):r.spmD:p.d=l.spmD?encodeURIComponent(l.spmD):"",a.push({dataset:u,config:r,element:s,spmData:p})}}})),1===a.length?r=a[0]:a.length>1&&(r=a.reduce((function(e,t){var n=e,r=e.element,a=t.element;return a.top>=r.top&&a.right<=r.right&&a.bottom<=r.bottom&&a.left>=r.left&&(n=t),n}))),r&&qr(de.CLK,r.dataset,r.config,r.element,r.spmData,n)}(e.event,a,e.context)}E.isArray(r)&&r.forEach((function(e){U.isStartWith(e.cssSelector,".")||(e.cssSelector=".".concat(e.cssSelector)),e.spmB||(e.spmB=n);var t=at.getPlatformContext().createSelectorQuery().selectAll(e.cssSelector);"function"==typeof t.fields?t.fields({id:!0,dataset:!0,rect:!0,scrollOffset:!0},(function(t){o(t,e)})).exec():t.boundingClientRect().exec((function(t){o(t,e)}))}))}(e)}]})}var Yr=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){Hr()}}]),Qr=ot(Object.freeze({__proto__:null,default:Yr}));function Wr(e){var t=H(q());return t&&t.getMetaInfo?t.getMetaInfo(e):Ue.getMetaCnt(e)}var zr=function(e){var t=e;try{var n=Wr("aplus-auto-exp-visible");return n&&(t=parseFloat(n)),t<=0&&(t=e),t}catch(r){return e}},Jr=zr(.3);zr("aplus-auto-exp-visible"),zr("aplus-auto-exp-window"),function(e){var t=300;try{var n=Wr("aplus-auto-exp-duration"),r=parseInt(n,10);return"NaN"!=="".concat(r)&&(t=r),t}catch(a){return t}}();var Xr,Zr=[];function ea(e,t,n,r){Xr&&!r||(Xr=at.getPlatformContext());var a,o=(Q("_aplus_auto_exp")||{}).hashMap||{};function i(e,t){var n=Fe.getHashKey(e,t);try{var r=e.index;if(o[t.logkey]){var a=0;o[t.logkey].forEach((function(t){t.hash_value===n&&(a=1,e.id&&(t.id=e.id),e.dataset&&(t.dataset=e.dataset),e.status&&(t.status=e.status))})),a||o[t.logkey].push({id:e.id,hash_value:n,status:0,expConfig:t,dataset:e.dataset,index:r})}else o[t.logkey]=[{id:e.id,hash_value:n,status:0,expConfig:t,dataset:e.dataset,index:r}]}catch(i){B().w("error === ",i)}}!function r(s){if(s<t.length){var c=t[s];a=0,Zr.forEach((function(e){e.subject[0]===c.cssSelector&&e.subject[1]===c.positionSelector&&(a=1)}));var u=[c.cssSelector,c.positionSelector];!function(e){var t=u[0];t&&!U.isStartWith(u[0],".")&&(t=".".concat(t));try{var n=Xr.createSelectorQuery().selectAll(t);"function"==typeof n.fields?n.fields({dataset:!0,id:!0},(function(t){E.isArray(t)&&t.length>0?e({elements:t,type:"COMMON"}):e({elements:[],type:"COMMON"})})).exec():B().w("current platform does not support auto exposure tracking!")}catch(r){B().w("current platform does not support auto exposure tracking! err = ",r)}}((function(r){if(0===a||0===n){var s=function(e){var t={thresholds:[Jr],initialRatio:0},n=!1;try{my&&(n=!0)}catch(r){}return n?(t.selectAll=!0,Xr.createIntersectionObserver(t)):(t.observeAll=!0,Xr.createIntersectionObserver(e,t))}(e);s.subject=u,Zr.length>t.length-1&&Zr.shift().disconnect(),Zr.push(s),E.each(r.elements,(function(e,t){var n,r,a,s;e.index="".concat(t+1),n=e,r=c,a=Fe.getHashKey(n,r),s=n.index,o[r.logkey]&&o[r.logkey].forEach((function(e){if(e.hash_value===a&&e.index===s)return!0})),i(e,c)})),p=s,f=function(e,t){mn.getIndexByRect(t.cssSelector,e.boundingClientRect,(function(n){var r=n+1;if(r){var a=b.cloneDeep(e);a.index="".concat(r);var o=b.cloneDeep(a.dataset);i({id:a.id,index:a.index,dataset:o},t),function(e,t,n){var r=function(e,t,n){var r=(Q("_aplus_auto_exp")||{}).hashMap||{},a=[];for(var o in r)if(Object.prototype.hasOwnProperty.call(r,o))for(var i=r[o]||[],s=0;s<i.length;s++){var c=Fe.getHashKey(t,n),u=i[s]||{};if(0===u.status&&u.expConfig&&c===u.hash_value){var p=t.boundingClientRect||{};if(p.width&&p.height){u.dataset=t.dataset,u.x=p.left,u.y=p.top,u.width=p.width,u.height=p.height,u.size=p.width*p.height;var l=Jr;t.intersectionRatio>=l&&(u.exposureTime=e,u.status=1,a.push(u))}}}return a}((new Date).getTime(),e,n);if(r&&r.length>0){var a=r[0],o={},i=C(t.trackerParams||{})||{},s=a.index;dn.getPageName()&&(o.b=dn.getPageName()),n.spmC?o.c=n.spmC:o.c=i.spmC?encodeURIComponent(i.spmC):"",n.spmD?o.d=s?"".concat(n.spmD,"_").concat(s):n.spmD:o.d=i.spmD?encodeURIComponent(i.spmD):"",qr(de.EXP,t,n,Object.assign({},e,{x:a.x,y:a.y,width:a.width,height:a.height,hash_value:a.hash_value}),o)}}(a,o,c)}}))},(g=(l=c).cssSelector)&&!U.isStartWith(g,".")&&(g=".".concat(g)),l.positionSelector?p.relativeTo(l.positionSelector).observe(g,(function(e){try{f(e,l)}catch(t){B().w("errorMessage: ",t)}})):p.relativeToViewport().observe(g,(function(e){try{f(e,l)}catch(t){B().w("errorMessage: ",t)}}))}var p,l,f,g})),r(++s)}}(0)}function ta(){for(var e=0;e<Zr.length;e++)Zr[e].disconnect();Zr=[];var t=(Q("_aplus_auto_exp")||{}).hashMap||{};for(var n in t)delete t[n]}var na={},ra=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){!function(){var e=$().ctx,t=0,n=0,r=H(q()),a=G();if(!r._aplus_auto_exp){r._aplus_auto_exp={hashMap:{}};var o=[];e[a].push({action:de.SUBSCRIBE,arguments:["onShow",function(e){if("ready"===e.status){i(e.context,1,de.SUBSCRIBE),0===t?(s(e.context,1),t=1):s(e.context,0);try{var n=at.getCurrentPage(),r=n.route||n.is;na[r]=r}catch(a){}}}]}),e[a].push({action:de.SUBSCRIBE,arguments:["onAplusTouch",function(e){"ready"===e.status&&(0===n?(n=1,s(e.context,1)):c(e))}]}),e[a].push({action:de.SUBSCRIBE,arguments:["onPageDataChanged",function(e){setTimeout((function(){c(e)}),200)}]}),e[a].push({action:de.SUBSCRIBE,arguments:["onHide",function(e){"ready"===e.status&&(na={},t=0,n=0,i(e.context,1,de.UNSUBSCRIBE),ta())}]}),e[a].push({action:de.SUBSCRIBE,arguments:["onUnload",function(e){"ready"===e.status&&(na={},ta())}]})}function i(t,n,r){e[a].push({action:r,arguments:["setMetaInfo",function(e,r){if("aplus-auto-exp"===e){var a=function(e){return function(e,t){var n,r=[],a=[];try{n=t||Wr(e);var o=[];if(n&&"string"==typeof n)try{o=JSON.parse(n)}catch(g){o=JSON.parse(n.replace(/'/g,'"'))}else"object"===v(n)&&n.constructor===Array&&(o=n);if(o&&o.constructor===Array)for(var i=0;i<o.length;i++){var s=o[i]||{},c=s.logkey||"",u=s.tag?s.tag:"",p=s.filter,l=s.cssSelector;if(!c||!(l||u&&p))throw new Error("meta ".concat(e," config error, ").concat(JSON.stringify(s)));p="string"==typeof p?p.split("="):[];var f=u;if(p.length>=2?f+="[".concat(p.shift(),'="').concat(decodeURIComponent(p.join("")),'"]'):1===p.length&&p[0]&&(f+="[".concat(decodeURIComponent(p[0]),"]")),l&&(f+=l),s.elementSelector=f,E.indexOf(a,f)>-1)throw new Error("meta ".concat(e," config error, tag_filter_cssSelector ").concat(f," repeated"));a.push(f),r.push(s)}return r}catch(g){return B().w(g),r}}("aplus-auto-exp",e)||[]}(r);if(JSON.stringify(a)===JSON.stringify(o))return;o=a,r&&o&&o.length>0&&ea(t,o,n)}}]})}function s(e,t){o=r.getMetaInfo("aplus-auto-exp"),setTimeout((function(){ea(e,o,t)}),0)}function c(e){try{var t=at.getCurrentPage(),n=t.route||t.is,r=na[n],a=JSON.stringify(e.data);r!==a&&(na[n]=a,s(e.context,0))}catch(o){}}}()}}]),aa=ot(Object.freeze({__proto__:null,default:ra})),oa=s((function e(t){o(this,e),this.options=t}),[{key:"pushQueue",value:function(e,t){H(G()).push({action:"".concat(q(),".").concat(e),arguments:t})}},{key:"run",value:function(){var e=this,t=H(q());y(me,(function(n){t[n]=function(){var t=[];y(arguments,(function(e){t.push(e)}));var r="enter"===n?"_sendPV":"_".concat(n);e.pushQueue(r,t)}}))}}]),ia=ot(Object.freeze({__proto__:null,default:oa})),sa=s((function e(t){o(this,e),this.options=t}),[{key:"_getNetworkType",value:function(e){var t=at.getPlatformContext();t.getNetworkType?t.getNetworkType({success:function(t){e(t?t.networkType:"")}}):e("")}},{key:"_getSystemInfo",value:function(e){var t=this,n={},r=t.SYSTEM_INFO||{};if(r&&r.version)e(t.SYSTEM_INFO);else try{at.getPlatformContext().getSystemInfo({complete:function(r){r&&r.version?t._getNetworkType((function(n){r.networkType=n,t.SYSTEM_INFO=r,e(r)})):t._getNetworkType((function(t){n.networkType=t,e(n)}))}})}catch(a){e(n)}}},{key:"_getAccountInfoSync",value:function(){var e={};try{var t=at.getPlatformContext();if(t.getAccountInfoSync&&t.canIUse("getAccountInfoSync")){var n=t.getAccountInfoSync(),r=n.miniProgram||{},a=n.plugin||{};e.appId=r.appId,e.appVersion=r.version||r.envVersion,e.pluginAppId=a.appId,e.pluginAppVersion=a.version}else if(t.getAppIdSync&&t.canIUse("getAppIdSync")){var o=t.getAppIdSync()||{};e.appId=o.appId||""}}catch(i){}return e}},{key:"run",value:function(e,t){var n=this;return this._getSystemInfo((function(e){e.userAgent="-",e.os=e.platform?e.platform.toLocaleUpperCase():"",e.os_version=e.system?e.system:"",e.access=e.brand?e.brand:"";var r="";e.host&&"string"==typeof e.host.env&&(r=e.host.env),e.host=r;var a=n._getAccountInfoSync(),o=Object.assign({},e,a);H(q())._aplus_client=o,t()})),2e3}}]),ca=ot(Object.freeze({__proto__:null,default:sa})),ua=s((function e(t){o(this,e),this.options=t}),[{key:"run",value:function(){var e=this.options.context.sdk_config.queueName,t=$(),n=ht(t[e]||[],"metaQueue");t[e]=n.queue,st(n.formatQueue,this.options.config)}}]),pa=ot(Object.freeze({__proto__:null,default:ua})),la=s((function e(t){o(this,e),this.options=t}),[{key:"enableSDK",value:function(e){$().ctx[G()].push({action:de.SDK_SET_META_INFO,arguments:["_hold",e?"START":"BLOCK"]})}},{key:"emptyAnonyID",value:function(){$().ctx[G()].push({action:de.SDK_SET_META_INFO,arguments:[de._ANONY_ID,""]})}},{key:"run",value:function(){var e=this.options.context.sdk_config.metaInfo,t=H(q()),n=H(G()),r=e[Ie.AUTO_GET_OPENID],a=at.getPlatformContext(),o=t&&t.getMetaInfo&&t.getMetaInfo(de._ANONY_ID);if(r&&!o){var i=this;i.enableSDK(!1);var s=at.getPlatformType();try{if("wx"===s){var c=a.getAccountInfoSync().miniProgram.appId,u=a.getStorageSync&&a.getStorageSync(de._ANONY_ID),p=a.getStorageSync&&a.getStorageSync(de._DEV_ID);if(u)n.push({action:de.SDK_SET_META_INFO,arguments:[de._ANONY_ID,u]}),n.push({action:de.SDK_SET_META_INFO,arguments:[de._DEV_ID,p]}),i.enableSDK(!0);else{var l=e.appKey||Fe.getAppKey();a.login({success:function(r){if(r.code){var a=e[Ie.APLUS_PV_DOMAIN]||e[Ie.TRACKDOMAIN],o="".concat(a,"/mp/get_openid");at.request(o,{method:Oe.POST,dataType:"json",data:{appkey:l,code:r.code,appid:c,platform:s}},(function(e){if(e&&e.data&&200===e.data.code){var r=e.data.data;At().set(de._ANONY_ID,r.od),At().set(de._DEV_ID,r.ud),t.od=r.od,n.push({action:de.SDK_SET_META_INFO,arguments:[de._ANONY_ID,r.od]}),n.push({action:de.SDK_SET_META_INFO,arguments:[de._DEV_ID,r.ud]}),i.enableSDK(!0)}else B().w("auto get openid failed errMsg:",e.data.message),i.emptyAnonyID(),i.enableSDK(!0)}),(function(e){B().w("auto get openid failed, errmsg = ",e&&e.message),i.emptyAnonyID(),i.enableSDK(!0)}))}else B().w("auto get openid failed"),i.emptyAnonyID(),i.enableSDK(!0)},fail:function(){B().w("wechat login failed"),i.emptyAnonyID(),i.enableSDK(!0)}})}}else B().w("current miniapp platform:".concat(s," not support autoGetOpenid, please setMetaInfo _anony_id by yourself!"))}catch(f){B().w("get openid failed, errmsg = ",f),i.emptyAnonyID(),i.enableSDK(!0)}}else B().w("auto get openid setting is",r?"true":"false")}}]),fa={apiName:"aplus",queueName:"aplus_queue",metaInfo:{sdk_version:it,trackDomain:"",appKey:"",sdkId:"qt_mini","aplus-cpvdata":{},"aplus-exdata":{},"aplus-globaldata":{},"aplus-mmstat-timeout":"10000","aplus-disable-autoevent":!1,"aplus-request-timeout":3e3,"aplus-mini-requests-limit":1},globalConfig:{ETAG_STORAGE_KEY:"__ETAG__CNA__ID__",script_name:"qt_mini.js",lver:it},plugins:[{name:"aplus_queue",path:Et},{name:"inject_app_um",path:fn},{name:"inject_page_um",path:Mn},{name:"pubsub",path:jn},{name:"aplus_mini_report_um",path:$n},{name:"aplus_meta_inject",path:Jn},{name:"aplus_log_inject",path:Zn,deps:["aplus_meta_inject"],config:{plugins:{pv:[{name:"when_to_sendpv",path:tr,config:{aplusWaiting:""}},{name:"where_to_send",path:rr},{name:"what_to_send",path:pr},{name:"miniapp_data",path:fr},{name:"what_to_sendpv_userdata",path:_r,deps:["what_to_send"]},{name:"can_to_sendpv",path:Ar}],hjlj:[{name:"where_to_send",path:rr},{name:"what_to_send",path:pr,deps:[]},{name:"miniapp_data",path:fr},{name:"what_to_hjlj_userdata",path:Pr}]}}},{name:"aplus_api",path:Dr,deps:["aplus_log_inject","aplus_meta_inject"]},{name:"auto_tracker_um",path:Vr,deps:["inject_page_um"]},{name:"aplus_ac",path:Qr,deps:["inject_page_um"]},{name:"aplus_ae",path:aa,deps:["inject_page_um"]},{name:"open_api",path:ia},{name:"aplus_client",path:ca},{name:"meta_queue",path:pa},{name:"auto_openid",enable:!0,path:ot(Object.freeze({__proto__:null,default:la})),config:{},deps:["aplus_meta_inject"]}]};exports.Ra=function(e){return t="QuickTracking SDK INIT SUCCESS!",function(e,t,n){var r,a,o,i;return r=at.getPlatformContext(),a={apiName:t.apiName,queueName:t.queueName},K=r._sdk_context||V.create(r,a),"object"===v(e)&&(t.metaInfo=Object.assign({},t.metaInfo,e.metaInfo)),B().setDebug(e.metaInfo.DEBUG),t.metaInfo&&t.metaInfo.disableSDK&&(at.setStorageSync(Ie.APLUS_SDK_DISABLE,!0),B().w("QuickTracking SDK is disabled!!!")),X([de.SDK_READY,"running"]),o={plugins:t.plugins,context:function(){var e={PAGE_LOAD_TIME:new Date},n=[];return E.each(t.plugins,(function(t){e[t.name]=t.config,"aplus_log_inject"===t.name&&t.config&&t.config.plugins&&(n=t.config.plugins.pv,E.each(n,(function(t){e[t.name]=t.config})))})),Object.assign({},e,{sdk_config:t})}},i=function(e){n&&D(n)&&n(e)},(new re).run({plugins:o.plugins,context:o.context},{config:{},userdata:{},pubsubType:"aplusinit",messageFnQueue:[],middlewareMessageKey:"mw_change_aplusinit"},(function(e){var t=["aplusInitContext",e];X(t),Z(t),D(i)&&i(e)})),$()}(e,fa,(function(){B().v(t||"QT SDK INIT SUCCESS!")}))};
