"use strict";const e=require("../../../common/vendor.js"),o=require("../../../local/index.js");require("../../../hooks/uni-hooks/new-dialog.js"),require("../../../store/modules/app.js");const r=require("../../../store/modules/device.js");require("../../../store/modules/order.js");const u=require("../../../store/modules/user.js"),s=require("../../../utils/format.js"),t=require("../../../utils/order.js");require("../../../utils/uniAsync.js"),require("../../../utils/wx.log.js"),require("../../../utils/config/index.js"),require("../../../hooks/uni-hooks/dialog.js"),require("../../../hooks/uni-hooks/request.js");const n=require("../../../const/order.js"),i=require("../../../hooks/uni-hooks/wechat.js"),a=require("../../../api/user.js");require("../../../hooks/useCountryCode.js");const p=require("../../../hooks/use-mix.js");require("../../../shared/order.js"),require("../../../shared/pay.js");const d=require("../../../shared/coupon.js");if(require("../../../hooks/uni-hooks/unite.js"),require("../../../const/platform.js"),require("../../../shared/cache.js"),require("../../../const/cache.js"),require("../../../hooks/uni-hooks/cache.js"),require("../../../utils/config/env.js"),require("../../../uni_modules/mot-utils/index.js"),require("../../../theme/hooks/useTheme.js"),require("../../../theme/hooks/themeConfig.js"),require("../../../theme/hooks/themeKeys.js"),require("../../../api/device.js"),require("../../../api/order.js"),require("../../../hooks/uni-hooks/router.js"),require("../../../hooks/usePromise.js"),require("../../../api/delivery.js"),require("../../../shared/device.js"),require("../../../const/common.js"),require("../../../utils/appEnterVerif.js"),require("../../../const/coupon.js"),require("../../../hooks/use-common.js"),require("../../../hooks/uni-hooks/loading.js"),require("../../../hooks/uni-hooks/common.js"),require("../../../utils/url.js"),require("../../../hooks/uni-hooks/report.js"),require("../../../api/data.js"),require("../../../utils/precision.js"),require("../../../hooks/useWechatSI.js"),require("../../../hooks/use-keyval/index.js"),require("../../../utils/is.js"),!Array){(e.resolveComponent("uni-icons")+e.resolveComponent("mot-button")+e.resolveComponent("uni-popup"))()}Math||((()=>"../../../uni_modules/uni-icons/components/uni-icons/uni-icons.js")+(()=>"../../../uni_modules/mot-button/components/mot-button/mot-button.js")+(()=>"../../../uni_modules/uni-popup/components/uni-popup/uni-popup.js"))();const c=e.defineComponent({__name:"index",props:{modelValue:{type:Boolean,default:!1},orderData:{type:Object,default:()=>{}},loading:{type:Boolean,default:!1},showFaceItem:{type:Boolean,default:!1},showPwdItem:{type:Boolean,default:!1}},emits:["update:modelValue","confirm","update:loading"],setup(c,{emit:l}){const m=c,h=r.useDeviceStore(),f=u.useUserStore(),j=r.useDeviceStoreRefs(),q=e.computed((()=>{const{payRule:{deposit:e,prepaid:o},payed:r,coupon:u}=m.orderData;return t.showRechargeMoney({payed:r,coupon:u,money:o+e})})),{cabinet:y}=j,v=e.computed({get:()=>m.modelValue,set:e=>l("update:modelValue",e)}),k=e.ref();e.watch((()=>m.modelValue),(async o=>{await e.nextTick$1(),o?k.value&&k.value.open():k.value&&k.value.close()}),{immediate:!0});const _=e.computed({get:()=>m.loading,set:e=>l("update:loading",e)}),g=e.computed((()=>h.freeLocker)),w=e.computed((()=>{const{require_phone:e}=h.site,{depositType:o}=m.orderData;return(null==e?void 0:e.includes(o))||o===n.DepositTypeEnum.PhonePassword})),D=e.computed((()=>d.showCouponText({coupon:m.orderData.coupon,payRule:m.orderData.payRule}))),b=()=>{v.value=!1},x=async()=>{if(i.envEvent.report.addClick("a_page_deposit_confirm_clk"),_.value)return;_.value=!0;const{page:e}=f.sceneInfo,o="home"===e?n.SubscribeMessageType.CREATE:n.SubscribeMessageType.RESERVE,r=await a.userApi.getTemplateIds({sub_type:o});i.envEvent.subscribeMessage(r||[]).finally((()=>{l("confirm")}))};return(r,u)=>{var t,n,i,a;return e.e({a:e.t(e.unref(o.t)("popup.v1_pay.sub_title")),b:e.o(b),c:e.p({type:"closeempty",size:"18",color:"#555"}),d:e.t(e.unref(o.t)("popup.v1_pay.locker_no")),e:!e.unref(g).id},e.unref(g).id?{g:e.t(e.unref(s.fullLockerName)(e.unref(g).name,e.unref(y).address))}:{f:e.t(e.unref(o.t)("popup.pay.lockerInstructions.autoAllocation"))},{h:e.t(e.unref(o.t)("popup.v1_pay.voucher")),i:c.showFaceItem},c.showFaceItem?{j:e.t(e.unref(o.t)("popup.v1_pay.face")),k:c.orderData.faceUrl}:{},{l:e.unref(w)},e.unref(w)?{m:e.t(e.unref(o.t)("popup.v1_pay.phone")),n:e.t(c.orderData.phone)}:{},{o:c.showPwdItem},c.showPwdItem?{p:e.t(e.unref(o.t)("popup.v1_pay.password")),q:e.t(c.orderData.password)}:{},{r:e.t(e.unref(o.t)("components.v1.pay-popup.index.3")),s:e.t(e.unref(p.useToYuan)(c.orderData.payRule.prepaid)),t:e.unref(q)>0},e.unref(q)>0?{v:e.t(e.unref(o.t)("components.business.recharge-popup.index.4")),w:e.t(e.unref(p.useToYuan)(e.unref(q)))}:{},{x:c.orderData.payRule.deposit},c.orderData.payRule.deposit?{y:e.t(e.unref(o.t)("order.detail.order_deposit")),z:e.t(e.unref(p.useToYuan)(c.orderData.payRule.deposit))}:{},{A:null==(n=null==(t=c.orderData)?void 0:t.coupon)?void 0:n.id},(null==(a=null==(i=c.orderData)?void 0:i.coupon)?void 0:a.id)?{B:e.t(e.unref(o.t)("components.v1.coupon.coupon-panel.1")),C:e.t(e.unref(D))}:{},{D:e.t(e.unref(o.t)("popup.v1_pay.btn")),E:c.orderData.payed>0},c.orderData.payed>0?{F:e.t(e.unref(p.useToYuan)(c.orderData.payed))}:{},{G:e.o(x),H:e.p({isBlock:!0,shape:"square",loading:e.unref(_)}),I:e.sr(k,"25edd3df-0",{k:"popup"}),J:e.o(b),K:e.p({"safe-area":!1,type:"bottom",borderRadius:"10px"})})}}}),l=e._export_sfc(c,[["__scopeId","data-v-25edd3df"]]);wx.createComponent(l);
