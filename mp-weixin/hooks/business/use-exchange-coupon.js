"use strict";const e=require("../../common/vendor.js");require("../../local/index.js"),require("../uni-hooks/new-dialog.js"),require("../../store/modules/app.js"),require("../../store/modules/device.js"),require("../../store/modules/order.js"),require("../../store/modules/user.js");const o=require("../../const/coupon.js");require("../../utils/uniAsync.js"),require("../../utils/wx.log.js"),require("../../utils/config/index.js"),require("../uni-hooks/dialog.js"),require("../uni-hooks/request.js");const s=require("../uni-hooks/router.js");require("../uni-hooks/wechat.js");const u=require("../../api/coupon.js");require("../useCountryCode.js");const r=e.ref("");exports.useExchangeCouponGlobal=()=>(e.onLoad((()=>{r.value=""})),{onScan:()=>{e.index.scanCode({success:e=>{r.value=e.result}})},onExchange:async e=>{const n=r.value.includes("wyc")?o.CouponChannelEnum.WUYOUCUN:o.CouponChannelEnum.MEITUAN,{id:i}=await u.couponExchangeApi.post({code:r.value.replace(/\s+/g,""),shop_id:null==e?void 0:e.id,consume_channel:n});s.reLaunch(`/sub-pages/me/coupon-result/index?couponPackageId=${i}&from=exchange`)},code:r});
